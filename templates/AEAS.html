<!DOCTYPE html>

<html>
<head >
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <title>太空桌遊網頁版</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"/>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <style>
        body {
            width: 100vw;
            height: 100vh;
            overflow: hidden;
            background-image:url('static/back.jpg');
            background-attachment: scroll;
            background-repeat: no-repeat; 
            background-blend-mode: multiply;
            background-position:center;
            background-size:cover;
            font-size:2vmin;
        }
        .row {
            display: flex;
            height: 50vh;
            background-color:transparent;
        }
        .col-md-2 {
            display: flex;
            flex-direction: column;
            height:70vh;
            background-color:rgba(255, 255, 255, 0.05);
        }

        .col-md-2 .card {
            flex: 1;
        }
         .col-md-8 {
            display: flex;
            flex-direction: column;
            height:70vh;
            background-color:rgba(255, 255, 255, 0.05);
            border-left: 5px solid gray;
            border-right: 5px solid gray;
            
        }
        .board_desk{
            position:relative;
            width:100%;
            left:0%;
            
        }
        .board_desk img{
            width:100%;
            height:20vh;
            transition: transform 0.8s;

        }

        .hand-area img {
              transition: transform 0.2s;
        }

        .board_desk img:hover {
              transform: rotateY(180deg);
        }

        .hand-area img:hover {
              transform: translate(0px, -10px) ;
        }

        .mission{
            position:relative;
            width:100%;
            height:auto;
            left:0%;
            
          
        }
        .main_area{
             /*background-color:rgba(255,255,255,1);*/
            /* background-image:url('https://4.jimtechtalks.top/file=D:/Github/stable-diffusion-webui/outputs/txt2img-images/2023-10-27/00072-4076367103.png?1698377675.4982777'); */

            /* background-image:url('static/main.jpg');
            background-size:contain;
            background-repeat:no-repeat; */
            
            background-color:transparent; 
        }
        .self-area{
            /* background-image:url('static/right.jpg');
            background-attachment: scroll;
            background-repeat: no-repeat; 
            background-blend-mode: multiply;
            background-position:center;
            background-size:contain; */
            background-color:transparent;
            /* background-color:rgba(255,255,255,0.2); */
        }
        .hand-area-T{
            
            background-image:url('static/hand.jpg');
            background-attachment: scroll;
            background-repeat: no-repeat; 
            background-blend-mode: multiply;
            background-position:center;
            background-size:cover;
            border-top: 5px solid darkgray;
            background-color:rgba(255,255,255,0.2);
        }
        .other-player{
            /* border: 5px solid; */
            /* background-image:url('static/left.jpg');
            background-attachment: scroll;
            background-size:contain;
            background-repeat: no-repeat; 
            background-blend-mode: multiply;
            background-position:center; */
            /* background-color:rgba(255,255,255,0.2); */

        }
        #ssdis{
            background-image:url('static/main.jpg');
            background-repeat: no-repeat; 
            background-blend-mode: multiply;
            background-position:center;
            background-size:cover;
            border: 5px solid white;
        }
        .mission td{
            text-align:center;
            padding:10px;
            border:0px solid;
            /* background-color:rgba(100,100,255,0.1); */
            border-radius:20px;
            /* color: white; */
        }
            
        .mission img{
            width:8vh;
            height:auto;
            position: relative;
            transition: transform 0.4s;
        }
        .hand-area td{
            padding:10px;
        }

        .tooltips {
          position: fixed;
          padding:10px;
          background-color:white;
          border-radius:10px;
          border:3px solid;
          height:auto;
          width:auto;
          top:100px;
          left:10%;
          z-index:999999999;
          display:block;
        }
        .tech{
            position:relative;
            width:100%;
            height:auto;
            left:0px;
        }
        .tech td{
            border:1px solid;
        }
        .build{
            position:relative;
            width:100%;
            height:auto;
            left:0px;
        }
        .build td{
            border:1px solid;
        }

        

        .self-area-T{
           /* background-color:rgba(255,255,255,0.2); */
           text-align:center;
           border: 0px solid green;
        }
       

        main {
            text-align: center;
          }
          
          .figure {
            bottom: 29vh;
            max-width: 40vw;
            position: fixed;
            left: 30%;
            z-index: 9;
            overflow: visible;
            
          }
         
          .smoke {
            animation: smoke .1s 70 ease-in-out alternate;
          }
          @keyframes smoke {
            0% {
              transform: translate3d(-5px, 0, 0);
            }
            100% {
              transform: translate3d(5px, 0, 0);
            }
          }
          .flame {
            animation: burnInner2 .1s 70 ease-in-out alternate;
          }
          @keyframes burnInner2 {
            0% {
              transform: translate3d(0, 0, 0);
            }
            100% {
              transform: translate3d(0, 3px, 0);
            }
          }
          @keyframes thrust {
            0% {
              opacity: 1;
            }
            100% {
              opacity: .5;
            }
        }
        #mission_complete{
            /* position: fixed;
            z-index: 100;*/
            top:20vh ;
            display: none;

        }
        main h1 {
            font-size: 2.375rem;
            max-width: 32rem;
            margin: 5px auto 0;
            color:red;
            position: relative;
            top: 60vh;
            z-index: 9;
          }
        #player_zone{
            height: 70vh;
            overflow:hidden;
        }
       
        #player_zone:hover{
            overflow-y: scroll;
        }
       
        .OtherPlayer img:hover{
            width: 100%;
        }
        
          
        .triangle {
            position: relative;
            width: 0;
            height: 0;
            top: 0px;
            left: 45%;
            border-left: 50px solid transparent;
            border-right: 50px solid transparent;
            border-bottom: 50px solid rgba(14, 108, 230, 0.8); /* 您可以更改顏色 */
        }
        #orderSheet img{
            width: 100%;
            position: relative;
            transition: transform 0.8s;
        }
        #orderSheet td{
            text-align: center;
        
        }
    </style>
    </style>
    <script>
        //2023/10/23 TODO : 任務執行完成後，要替換任務需求內容 OK
        //2023/10/30 TODO : 已完成初階任務蓋牌動作，換中階任務蓋牌 OK
        //2023/10/31 TODO : 已完成4大動作設定，目前須增加反悔動作，將check_init 歸零 並重新選擇動作 OK
        //2023/11/01 TODO : 每一個蓋牌動作完成後，如果只選擇蓋一張，可以點及黑幕退出，黑幕退出後需要歸零動作，如: 清除check_init狀態，卡面恢復
        // 2023/11/02 TODO : 完成其他玩家動態區，完成後開始規劃玩家互動部分
        //全域變數
        // 2023/11/14 TODO : 將資源都建立到後端去，並將所有動作(拿資源、蓋資源、出任務、蓋任務)都變為POST到後端對資源json格式做新增與刪除，同時須記錄下使用者的手牌及技術資訊
        // 2023/11/17 TODO : 已完成資源、任務牌在初始化後從後端洗牌後送往前端， 剩餘需處理 1.儲存玩家狀態(手牌、技術、建設) 2.牌拿取後除了pop調之外，也要同步更新後端
        // 2023/11/20 TODO : 已將玩家狀態(僅手牌、無技術與建設)；資源任務牌都POST到後端，剩餘需讓後端回送回資源值 以更新全局
        // 2023/11/22 TODO : 處理重新載入的bug，新增了所有變數的可觀頁面，確認當前卡牌狀況，剩餘須完成部分，從python後端行:302開始 將手牌、技術與建設加入到個人的內容中。
        // 2023/11/27 TODO : 已處理網頁reload後，牌面刷新問題，尚未解決 1.玩家手牌reload後刷新歸零(11/28以處理) 2. 後端的資源及任務牌在玩家結束回合後不會更新
        // 2023/12/01 TODO : 發現BUG : 1.玩家回合時，刷新頁面會導致pass掉回合(已修正)2.玩家選擇資源後，其他玩家牌面沒有同步更新(同步更新問題已解決1212)
        // 2023/12/12 TODO : 目前還有的BUG:玩家回合結束後，會有後端傳送失敗，導致回合數一直卡在一位玩家身上的問題，
        // 目前尚未完成功能 : 1. 火箭發射回收後 擲金幣回收功能 2. 其他玩家卡牌區同步更新已執行任務的部分，同步更新應使用check_init= 99狀態下的每秒刷新
        // 2023/12/16 TODO : 發現覆蓋任物牌後，有任務牌無法替換的問題。(時有時無，目前已解決 但仍須測試)
        // ******************** 2024/01/02 TODO : 尚須完成事項 ********************
        //
        // 1. 選角畫面要有視窗顯示腳色背景及終極任務內容
        // 2. 終極任務要列入 並在開始遊戲時 綁定至各角色上
        // 3. 測試最終獲勝結果顯示。
        //
        //
        //0109 還是會有玩家完成後，沒有置換順序的情況發生。
        //0116 尚未改上0109問題，目前須先把所有的代號 置換為中文，且加入技術描述
        var userHandchoice = [];
        var checkcover = 0;//當使用者點擊覆蓋資源時為1
        var chec_cover_num = [];//計算使用者點擊覆蓋資源牌數
        var check_init = 0;//判斷使用者選擇動作，若未選擇則為0;
        var check_ended = 0;//判斷使用者是否完成動作;0代表已完成
        var check_rounds = 0;//判斷使用者回合是否開始，若開始則為一，結束則設為0
        var SourceAray = [];
        var Preliminary = [];
        var Intermed = [];
        var userHandsAll = [];//全部玩家當前手牌
        var userHands = [];//玩家當前手牌，狀態處理用
        var userTech = [];//玩家當前技術，狀態處理用
        var userBuild = [];//玩家當前建設，狀態處理用
        var Table_Source = {};//當前桌面資源
        var Table_Pre = {};//當前桌面初階任務
        var Table_Inter = {};//當前桌面中階任務
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        var final_Goal = ['A','B','C','D','E','F']

        // SourceAray = shuffleArray(SourceAray);
        // PreliminaryAray = shuffleArray(PreliminaryAray);
        // Intermediate = shuffleArray(Intermediate);
        // Preliminary = shuffleArray(Preliminary);//老錢版本
        // Intermed = shuffleArray(Intermed);//老錢版本
        //箭體使用3D列印 3種材質x各4支 - (拿到材料技術後才可升級火箭箭體)
        //6項近地酬載，每一項酬載對應6張初階任務牌，共計36張 - 初級推進36張 6種酬載x6張 
        //6項中距離酬載，每一項酬載對應3張中階任務牌，共計18張 - 中級推進18張 6種酬載x3張
        //6項終極任務，每一項任務需求對應3張中階任務報酬建設與其對應的3張初階任務報酬技術
        //推進器分為初(推力2)中(推力4)高階(推力6)，
        //箭體會針對任務的不同而有不同效果，如
        //不鏽鋼係數1x初級推進(2) = 2
        //鋁合金係數1.5x初級推進(2) = 3
        //鈦合金係數2x初級推進(2) = 4
        setInterval(() => {
            //先針對回合結束做結算，再更新回合至下個玩家
            var orderarea_img = document.getElementById("orderSheet").querySelectorAll("img")
            if(check_ended == 1){//檢查玩家是否已結束此回合
                    
                    userHands = [];
                    userTech = [];
                    userBuild = [];
                    tableSource = {};
                    tablePre = {};
                    tableInter = {};

                    var resource = document.getElementsByClassName('board_desk')[0];//.querySelectorAll('td')
                    var missions = document.getElementsByClassName('mission')[0];//.querySelectorAll('td')
                    // console.log(UTable_Source);
                    

                    for (var i = 0; i < document.getElementsByClassName("hand-area")[0].querySelectorAll("img").length; i++) {
                        userHands.push(document.getElementsByClassName("hand-area")[0].querySelectorAll("img")[i].id);
                    }
                    for (var c = 0; c < document.getElementsByClassName('tech')[0].querySelectorAll('img').length; c++) {
                        userTech.push(document.getElementsByClassName('tech')[0].querySelectorAll('img')[c].id);
                    }
                    for (var c = 0; c < document.getElementsByClassName('build')[0].querySelectorAll('img').length; c++) {
                        userBuild.push(document.getElementsByClassName('build')[0].querySelectorAll('img')[c].id);
                    }
                    for (var a = 0; a < resource.querySelectorAll('td').length; a++) {
                    if (a != 4) {
                            tableSource[a] = resource.querySelectorAll('td')[a].querySelector('img').id;
                        }
                    }
                    for (var a = 0; a < missions.querySelectorAll('td').length; a++) {
                        if (a <= 5) {
                        
                            if (a != 4 & a != 0 & a != 2) {
                                var needed = missions.querySelectorAll('td')[a].querySelector('img').className.split(' ');
                                if (needed.slice(1)[needed.slice(1).length - 1] == '') {
                                    // 如果是空值，使用 pop 方法刪除最後一個元素                                           
                                    needed.pop();
                                }
                                // Preliminary.unshift({"mission":this.querySelector('img').id,"Payload":needed[0],"Body":needed.slice(1),"Furl":needed_furl});

                                tablePre[a] = {
                                    "Body":needed.slice(1),
                                    "Furl": missions.querySelectorAll('td')[a].querySelector('img').alt,
                                    "mission":missions.querySelectorAll('td')[a].querySelector('img').id,
                                    "Payload":needed[0]
                                }
                            }
                        }else{
                            if (a != 7 & a != 9 & a != 11) {  
                                var needed = missions.querySelectorAll('td')[a].querySelector('img').className.split(' ');
                                var need_tech = needed.slice(0,2)
                                if (needed.slice(1)[needed.slice(1).length - 1] == '') {
                                    // 如果是空值，使用 pop 方法刪除最後一個元素                                           
                                    needed.pop();
                                }
                                //{ 'tech': ["A1A1", "A1A2"], 'mission': "A1A", "Payload": "AF1", "Body": ["AL_4", "ACM_3", "CMC_2"], "Furl": 15 },
                                // console.log({'tech': need_tech,"mission":this.querySelector('img').id,"Payload":needed[2],"Body":needed.slice(3),"Furl":needed_furl});
                                // Intermed.unshift({'tech': need_tech,"mission":this.querySelector('img').id,"Payload":needed[2],"Body":needed.slice(3),"Furl":needed_furl});
                                                  
                                tableInter[a] = {
                                    "tech":need_tech,
                                    "mission":missions.querySelectorAll('td')[a].querySelector('img').id,
                                    "Payload":needed[2],
                                    "Body":needed.slice(3),
                                    "Furl": missions.querySelectorAll('td')[a].querySelector('img').alt
                                }                        
                            }
                        }
                    }            
                    console.log("資源牌 : 刷新"+SourceAray);
                    $.ajax({
                        type: "POST",
                        url:  "resource",
                        data: JSON.stringify({
                            "SourceAray":SourceAray,//loading 資源牌
                            "Preliminary":Preliminary,    //loading 初階任務
                            "Intermed":Intermed,     //loading 中階任務
                            "user":sessionStorage.getItem('player'),
                            "userHands":userHands,
                            "userTech":userTech,
                            "userBuild":userBuild,
                            "Table_Source":tableSource,//即時更新桌面
                            "Table_Pre":tablePre,      //即時更新桌面
                            "Table_Inter":tableInter,  //即時更新桌面
                            "upd":1,                    //檢查玩家同時更新
                        }),
                        contentType: "application/json; charset=utf-8",
                        dataType: "json",
                        success: function (data) {
                            console.log("pass");
                            check_rounds = 0;//回合結束
                            refresh_Table(Table_Source,Table_Pre,Table_Inter);
                        },error: function () {
                            // 请求失败后的处理
                            console.log("請求失敗");
                        }
                    });
                }
           
            $.ajax({
                type: "POST",
                url:  "round",
                data: JSON.stringify({
                    "user_state": check_ended,
                    "user_id":document.getElementById("avatar").alt,
                }),
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (data) {  
                    check_ended = 0;               
                    for (var key = 0;key < orderarea_img.length;key++ ) {
                        if(document.getElementById("avatar").alt != data["order_now"]){
                            check_init = 99;//確認是否為玩家回合，若否則無法執行動作。
                            //在非自己回合時，持續更新桌面牌
                            $.ajax({
                                type: "GET",
                                url:  "resource",
                                contentType: "application/json; charset=utf-8",
                                dataType: "json",
                                success: function (data) {
                                    // console.log('刷新中');
                                    // console.log(data["Table_Source"]);
                                    refresh_Table(data["Table_Source"],data["Table_Pre"],data["Table_Inter"]);
                                    
                                }
                            })
                        }else{
                            //當進入自己回合時
                            if(check_rounds == 0){
                                check_init = 0;
                                check_rounds = 1;//歸零回合開始-僅執行一次，避免重複執行影響選牌
                                document.getElementById("round_move_back").style.display = "block";
                                document.getElementById("round_move_back").style.zIndex = 99;
                                document.getElementById("round_move_font").style.display = "block";
                                document.getElementById("round_move_font").style.zIndex = 100;
                                $.ajax({
                                type: "GET",
                                url:  "resource",
                                contentType: "application/json; charset=utf-8",
                                dataType: "json",
                                success: function (data) {
                                    console.log('刷新中');
                                    console.log(data["User_Hand"]);
                                    
                                    refresh_Table(data["Table_Source"],data["Table_Pre"],data["Table_Inter"]);//刷新桌面牌
                                    //刷新牌庫
                                    SourceAray = data["resource"];//loading 資源牌
                                    Preliminary = data["Pre"];    //loading 初階任務
                                    Intermed = data["Inter"];     //loading 中階任務
                                    userHandsAll = data["User_Hand"];   //玩家手牌
                                    for (var keys = 0;keys < orderarea_img.length;keys++ ) {
                                        console.log(keys);
                                        for(var techss = 0;techss < userHandsAll[orderarea_img[keys].id]["Tech"].length;techss ++){
                                            var otherID = orderarea_img[keys].src.slice(-6).substring(0,2);//其他玩家的角色
                                            for (var b = 0; b < $("."+otherID+"_tech tr").length; b++) {
                                                var check = 0;//檢測欄位是否為1
                            
                                                for (var c = 0; c < document.getElementsByClassName(otherID+'_tech')[0].querySelectorAll('tr').length; c++) {
                                                    if (document.getElementsByClassName(otherID+'_tech')[0].querySelectorAll('tr')[b].querySelectorAll('td')[c].innerHTML == "")
                                                    {
                                                        var d = document.createElement("img");
                                                        d.id =  userHandsAll[orderarea_img[keys].id]["Tech"][techss];
                                                        d.src = "static/mission.jpg";
                                                        d.style.height = "8vh";
                                                        document.getElementsByClassName(otherID+'_tech')[0].querySelectorAll('tr')[b].querySelectorAll('td')[c].appendChild(d);
                                                        document.getElementsByClassName(otherID+'_tech')[0].querySelectorAll('tr')[b].querySelectorAll('td')[c].addEventListener('mousemove', function (event) {
                                                            event = event || window.event; // 兼容性處理
                                                            console.log("迴圈處理");

                                                            var mouseX = event.clientX;
                                                            var mouseY = event.clientY;
                                                            document.getElementsByClassName('tooltips')[0].innerHTML = "任務 : <br/>" + d.id + "技術 : XXX"
                                                            document.getElementsByClassName('tooltips')[0].style.left = mouseX + "px";
                                                            document.getElementsByClassName('tooltips')[0].style.top = mouseY + "px";
                                                            document.getElementsByClassName('tooltips')[0].style.display = "block"
                                                        });

                                                        document.getElementsByClassName(otherID+'_tech')[0].querySelectorAll('tr')[b].querySelectorAll('td')[c].addEventListener('mouseleave', function (event) {
                                                            document.getElementsByClassName('tooltips')[0].style.display = "none"
                                                        });
                                                        check = 1
                                                        break;
                                                    }                                              
                                                }
                                                if (check == 1) {
                                                    break;
                                                }
                                            }
                                        }
                                        }
                                    }
                                });
                            }
                        }
                        if(orderarea_img[key].alt == data["order_now"]){//檢查是否為玩家回合
      
                            document.getElementById("orderSheet").rows[1].cells[key+1].style.color = "red"                           
                            //break;
                        }
                        else{
                            document.getElementById("orderSheet").rows[1].cells[key+1].style.color = "black";//非該回合玩家，字體顯示黑色
                        }
                    }      
                    
                },error: function () {
                    // 请求失败后的处理
                    console.log("請求失敗");
                }
            });

            
    }, 500);

    function refresh_Table(UTable_Source,UTable_Pre,UTable_Inter){
        var resource = document.getElementsByClassName('board_desk')[0];//.querySelectorAll('td')
        var missions = document.getElementsByClassName('mission')[0];//.querySelectorAll('td')
        // console.log(UTable_Source);
        for (var a = 0; a < resource.querySelectorAll('td').length; a++) {
        if (a != 4) {
                
                resource.querySelectorAll('td')[a].querySelector('img').id =  UTable_Source[a];
                resource.querySelectorAll('td')[a].querySelector('img').alt = a; 
                
            }
        }
        for (var a = 0; a < missions.querySelectorAll('td').length; a++) {
            if (a <= 5) {
            
                if (a != 4 & a != 0 & a != 2) {

                    missions.querySelectorAll('td')[a].querySelector('img').className = "";
                    missions.querySelectorAll('td')[a].querySelector('img').id = UTable_Pre[a]["mission"];
                    missions.querySelectorAll('td')[a].querySelector('img').className += UTable_Pre[a]['Payload']+" ";
                    for (var clsname = 0; clsname < UTable_Pre[a]['Body'].length; clsname++) {
                        missions.querySelectorAll('td')[a].querySelector('img').className += UTable_Pre[a]['Body'][clsname] + " ";
                    }
                    missions.querySelectorAll('td')[a].querySelector('img').alt = UTable_Pre[a]['Furl'];
                    
                }
            }else{
                if (a != 7 & a != 9 & a != 11) {                            
                    missions.querySelectorAll('td')[a].querySelector('img').className = "";
                    missions.querySelectorAll('td')[a].querySelector('img').id = UTable_Inter[a]["mission"];
                    missions.querySelectorAll('td')[a].querySelector('img').className += UTable_Inter[a]['tech'][0] + " ";
                    missions.querySelectorAll('td')[a].querySelector('img').className += UTable_Inter[a]['tech'][1] + " ";
                    missions.querySelectorAll('td')[a].querySelector('img').className += UTable_Inter[a]['Payload'] + " ";
                    for (var clsname = 0; clsname < UTable_Inter[a]['Body'].length; clsname++) {
                        missions.querySelectorAll('td')[a].querySelector('img').className += UTable_Inter[a]['Body'][clsname] + " ";
                    }
                    missions.querySelectorAll('td')[a].querySelector('img').alt = UTable_Inter[a]['Furl']
                }
            }
        }                       
    }
        function corverItem(){//關閉黑屏
                var yes = confirm("確定結束回合?");
                if(yes){
                    if(chec_cover_num.length == 0){
                        var Passyes = confirm("未覆蓋任何卡牌，確定要結束回合?");
                        if(Passyes){
                            document.getElementById("mask").style.display = "none";
                            document.getElementById("mask").style.zIndex = "0";
                            document.getElementsByClassName("board_desk")[0].style.zIndex = "0";
                            checkcover = 0;
                            document.getElementById("regret").style.display = "none";
                            check_init = 0;//動作完成，退出回合;
                            console.log("退出");
                            check_ended = 1;
                        }
                    }
                    else if(chec_cover_num[0].length == 1){
                        //覆蓋資源
                        document.getElementsByClassName("board_desk")[0].querySelectorAll('td')[chec_cover_num[0]].querySelector('img').src = "https://img.ixintu.com/download/jpg/202001/685de4b8d9f54ffe6d8a533e92772584.jpg!con";
                        document.getElementById("mask").style.display = "none";
                        document.getElementById("mask").style.zIndex = "0";
                        document.getElementsByClassName("board_desk")[0].style.zIndex = "0";
                        checkcover = 0;
                        chec_cover_num = [];//覆蓋完牌後，退出回合;
                        check_init = 0;//動作完成，退出回合;
                        document.getElementById("regret").style.display = "none";
                        check_ended = 1;
                    }
                    else if(chec_cover_num[0].length == 2){
                        //覆蓋任務
                        console.log(chec_cover_num[0][0],chec_cover_num[0][1]);
                        document.getElementsByClassName("mission")[0].rows[chec_cover_num[0][0]].cells[chec_cover_num[0][1]].querySelector('img').src = "static/mission.jpg";
                        document.getElementById("mask").style.display = "none";
                        document.getElementById("mask").style.zIndex = "0";
                        document.getElementsByClassName("mission")[0].style.zIndex = "0";
                        checkcover = 0;
                        chec_cover_num = [];//覆蓋完牌後，退出回合;
                        check_ended = 1;
                    }
                }
        }

        $(document).ready(function () {
  

            var countPlayer = 0;
            var resource = document.getElementsByClassName('board_desk')[0];//.querySelectorAll('td')
            var missions = document.getElementsByClassName('mission')[0];//.querySelectorAll('td')

            //初始化玩家順序
            $.ajax({
                type: "GET",
                url:  "menber",
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (data) {
                    console.log(data["Final"])
                    for (var key in data["ordershu"]) {
                        var value = data["ordershu"][key];
                        console.log("初始SSS"+value);
                        if(key == sessionStorage.getItem('player')){
                            document.getElementById("avatar").src = "static/"+value[0]+".png";
                            document.getElementById("avatar").alt = value[1];
                            document.getElementById("avatar").addEventListener('mousemove', function (event) {
                                event = event || window.event; // 兼容性處理

                                var mouseX = event.clientX;
                                var mouseY = event.clientY;
                                document.getElementsByClassName('tooltips')[0].innerHTML =  
                                "任務 : "+data["Final"][value[0]]["mission"]+
                                "<br/>酬載 : "+data["Final"][value[0]]["Payload"]+
                                "<br/>需求建設 : "+data["Final"][value[0]]["tech"]+
                                "<br/>需求箭體 : "+data["Final"][value[0]]["Body"]+
                                "<br/>需求燃料 :"+data["Final"][value[0]]["Furl"];
                                                                                           
                                document.getElementsByClassName('tooltips')[0].style.left = mouseX + "px";
                                document.getElementsByClassName('tooltips')[0].style.top = mouseY + "px";
                                document.getElementsByClassName('tooltips')[0].style.display = "block"
                            });

                            document.getElementById("avatar").addEventListener('mouseleave', function (event) {
                                document.getElementsByClassName('tooltips')[0].style.display = "none"
                            });

                        }else{
                            var playerArea = document.getElementsByClassName('OtherPlayer')[0].cloneNode(true);
                            playerArea.querySelector("img").src = "static/"+value[0]+".png";
                            playerArea.querySelector("img").alt = value[1];
                            playerArea.querySelector("img").id="PlayerA"+value[1];
                            playerArea.querySelector("span").innerHTML = "&nbsp;&nbsp;"+key;
                            playerArea.style.display = "block";
                            playerArea.querySelectorAll("table")[0].className = value[0]+"_tech";
                            playerArea.querySelectorAll("table")[1].className = value[0]+"_build";
                            console.log(playerArea.querySelectorAll("table"))
                            document.getElementsByClassName('other-player')[0].appendChild(playerArea);
                        }      
                                           
                    }
                }
            });
            //初始化資源卡牌-僅初次載入時執行一次

            
                $.ajax({
                    type: "GET",
                    url:  "resource",
                    contentType: "application/json; charset=utf-8",
                    dataType: "json",
                    success: function (data) {
                        console.log("測試")
                        if(!sessionStorage.getItem('Initshuffle')){
                            SourceAray = data.resource;//loading 資源牌
                            Preliminary = data.Pre;    //loading 初階任務
                            Intermed = data.Inter;     //loading 中階任務
                            Table_Source = data["Table_Source"];//loading 資源牌
                            Table_Pre = data["Table_Pre"];    //loading 初階任務
                            Table_Inter = data["Table_Inter"];     //loading 中階任務
                        }
                        else{
                            SourceAray = data["resource"];//loading 資源牌
                            Preliminary = data["Pre"];    //loading 初階任務
                            Intermed = data["Inter"];     //loading 中階任務
                            Table_Source = data["Table_Source"];//loading 資源牌
                            Table_Pre = data["Table_Pre"];    //loading 初階任務
                            Table_Inter = data["Table_Inter"];     //loading 中階任務
                            var userHand = data["User_Hand"];   //玩家手牌
                            console.log(userHand);
                            console.log(userHand[sessionStorage.getItem('player')])
                            for(var hands = 0;hands < userHand[sessionStorage.getItem('player')]["Hand"].length;hands ++){
                                for (var i = 0; i < $(".hand-area td").length; i++) {
                                            if (document.getElementsByClassName('hand-area')[0].querySelectorAll('td')[i].innerHTML == "") {
                                                var d = document.createElement("img");
                                                d.id =  userHand[sessionStorage.getItem('player')]["Hand"][hands];
                                                d.style.height = "18vh";
                                                d.src="https://img.ixintu.com/download/jpg/202001/685de4b8d9f54ffe6d8a533e92772584.jpg!con";
                                                document.getElementsByClassName('hand-area')[0].querySelectorAll('td')[i].appendChild(d);//將卡牌從牌堆中轉至手牌區
                                                document.getElementsByClassName('hand-area')[0].querySelectorAll('td')[i].addEventListener('mousemove', function (event) {
                                                    event = event || window.event; // 兼容性處理

                                                    var mouseX = event.clientX;
                                                    var mouseY = event.clientY;
                                                    document.getElementsByClassName('tooltips')[0].innerHTML = "資源(燃料:Delta、箭體、酬載:BF) : <br/>" + this.querySelector('img').id 
                                                    document.getElementsByClassName('tooltips')[0].style.left = mouseX + "px";
                                                    document.getElementsByClassName('tooltips')[0].style.top = mouseY + "px";
                                                    document.getElementsByClassName('tooltips')[0].style.display = "block"
                                                });

                                                document.getElementsByClassName('hand-area')[0].querySelectorAll('td')[i].querySelector('img').addEventListener('click', function (event) {
                                                    if(check_init == 3){
                                                        console.log("test測試");
                                                        var imgtran = this;
                                                        console.log("test測試"+imgtran);

                                                        console.log("test測試"+imgtran.style.transform);
                                                        if (imgtran.style.transform == "") {
                                                        
                                                            if (userHandchoice.length < 3) {
                                                                console.log("test移動");
                                                                imgtran.style.transform = "translate(0px, -30px)";
                                                                userHandchoice.push(imgtran.id);
                                                                console.log(userHandchoice);
                                                            }

                                                        } else {
                                                            console.log("tes失敗");

                                                            imgtran.style.transform = "";
                                                            userHandchoice = userHandchoice.filter(item => item !== imgtran.id);
                                                            console.log(userHandchoice);
                                                        }
                                                    }
                                                    else if(check_init == 0){

                                                        document.getElementById("round_move_back").style.display = "block";
                                                        document.getElementById("round_move_back").style.zIndex = 99;
                                                        document.getElementById("round_move_font").style.display = "block";
                                                        document.getElementById("round_move_font").style.zIndex = 100;
                                                        return;
                                                    }

                                                });

                                                document.getElementsByClassName('hand-area')[0].querySelectorAll('td')[i].addEventListener('mouseleave', function (event) {
                                                    document.getElementsByClassName('tooltips')[0].style.display = "none"
                                                });

                                                break;
                                            }
                                        }
                            }
                            for(var techss = 0;techss < userHand[sessionStorage.getItem('player')]["Tech"].length;techss ++){
                                for (var b = 0; b < $(".tech tr").length; b++) {
                                    var check = 0;//檢測欄位是否為1
                
                                    for (var c = 0; c < document.getElementsByClassName('tech')[0].querySelectorAll('tr').length; c++) {
                                        if (document.getElementsByClassName('tech')[0].querySelectorAll('tr')[b].querySelectorAll('td')[c].innerHTML == "")
                                        {
                                            var d = document.createElement("img");
                                            d.id =  userHand[sessionStorage.getItem('player')]["Tech"][techss];
                                            d.src = "static/mission.jpg";
                                            d.style.height = "8vh";
                                            document.getElementsByClassName('tech')[0].querySelectorAll('tr')[b].querySelectorAll('td')[c].appendChild(d);
                                            document.getElementsByClassName('tech')[0].querySelectorAll('tr')[b].querySelectorAll('td')[c].addEventListener('mousemove', function (event) {
                                                event = event || window.event; // 兼容性處理
                                                console.log("迴圈處理");

                                                var mouseX = event.clientX;
                                                var mouseY = event.clientY;
                                                document.getElementsByClassName('tooltips')[0].innerHTML = "任務 : <br/>" + d.id + "技術 : XXX"
                                                document.getElementsByClassName('tooltips')[0].style.left = mouseX + "px";
                                                document.getElementsByClassName('tooltips')[0].style.top = mouseY + "px";
                                                document.getElementsByClassName('tooltips')[0].style.display = "block"
                                            });

                                            document.getElementsByClassName('tech')[0].querySelectorAll('tr')[b].querySelectorAll('td')[c].addEventListener('mouseleave', function (event) {
                                                document.getElementsByClassName('tooltips')[0].style.display = "none"
                                            });
                                            check = 1
                                            break;
                                        }
                                    
                                    }
                                    if (check == 1) {
                                        break;
                                    }
                                }
                            }
                            userHandsAll = data["User_Hand"];   //玩家手牌
                            var orderarea_img = document.getElementById("orderSheet").querySelectorAll("img")

                            for (var keys = 0;keys < orderarea_img.length;keys++ ) {
                                console.log(keys);
                                for(var techss = 0;techss < userHandsAll[orderarea_img[keys].id]["Tech"].length;techss ++){
                                    var otherID = orderarea_img[keys].src.slice(-6).substring(0,2);//其他玩家的角色
                                    for (var b = 0; b < $("."+otherID+"_tech tr").length; b++) {
                                        var check = 0;//檢測欄位是否為1
                    
                                        for (var c = 0; c < document.getElementsByClassName(otherID+'_tech')[0].querySelectorAll('tr').length; c++) {
                                            if (document.getElementsByClassName(otherID+'_tech')[0].querySelectorAll('tr')[b].querySelectorAll('td')[c].innerHTML == "")
                                            {
                                                var d = document.createElement("img");
                                                d.id =  userHandsAll[orderarea_img[keys].id]["Tech"][techss];
                                                d.src = "static/mission.jpg";
                                                d.style.height = "8vh";
                                                document.getElementsByClassName(otherID+'_tech')[0].querySelectorAll('tr')[b].querySelectorAll('td')[c].appendChild(d);
                                                document.getElementsByClassName(otherID+'_tech')[0].querySelectorAll('tr')[b].querySelectorAll('td')[c].addEventListener('mousemove', function (event) {
                                                    event = event || window.event; // 兼容性處理
                                                    console.log("迴圈處理");

                                                    var mouseX = event.clientX;
                                                    var mouseY = event.clientY;
                                                    document.getElementsByClassName('tooltips')[0].innerHTML = "任務 : <br/>" + d.id + "技術 : XXX"
                                                    document.getElementsByClassName('tooltips')[0].style.left = mouseX + "px";
                                                    document.getElementsByClassName('tooltips')[0].style.top = mouseY + "px";
                                                    document.getElementsByClassName('tooltips')[0].style.display = "block"
                                                });

                                                document.getElementsByClassName(otherID+'_tech')[0].querySelectorAll('tr')[b].querySelectorAll('td')[c].addEventListener('mouseleave', function (event) {
                                                    document.getElementsByClassName('tooltips')[0].style.display = "none"
                                                });
                                                check = 1
                                                break;
                                            }                                              
                                        }
                                        if (check == 1) {
                                            break;
                                        }
                                    }
                                }
                            }
                                    
                        }
                    
                    //給定資源及綁定功能
                    for (var a = 0; a < resource.querySelectorAll('td').length; a++) {
                            if (a != 4) {
                                //2023/12/12 棄用，直接由後端配發
                                // if(!sessionStorage.getItem('Initshuffle')){//初次進入時，統一分配
                                //     resource.querySelectorAll('td')[a].querySelector('img').id = SourceAray.pop();
                                //     resource.querySelectorAll('td')[a].querySelector('img').alt = a; 
                                //     Table_Source[a] = resource.querySelectorAll('td')[a].querySelector('img').id;
                                // }
                                // else{//第一次以上進入時，取Table_Source值
                                //     resource.querySelectorAll('td')[a].querySelector('img').id =  Table_Source[a];
                                //     resource.querySelectorAll('td')[a].querySelector('img').alt = a; 
                                // }
                                resource.querySelectorAll('td')[a].querySelector('img').id =  Table_Source[a];
                                resource.querySelectorAll('td')[a].querySelector('img').alt = a; 
                                resource.querySelectorAll('td')[a].addEventListener('click', function (e) {
                                    console.log("狀態"+check_init)
                                    if(check_init == 0){

                                        document.getElementById("round_move_back").style.display = "block";
                                        document.getElementById("round_move_back").style.zIndex = 99;
                                        document.getElementById("round_move_font").style.display = "block";
                                        document.getElementById("round_move_font").style.zIndex = 100;
                                        return;
                                    }
                                
                                    if(check_init != 1 & check_init != 2){
                                        return;
                                    }

                                    var sourced = this.querySelector('img');
                                    
                                    var d = sourced.cloneNode(true);
                                    if(check_init == 2){//覆蓋牌面

                                        if(checkcover == 1){
                                        if(chec_cover_num.length != 0){
                                            if(sourced.alt == chec_cover_num[0]){//防止已被覆蓋的牌再被選取
                                                return;
                                            }
                                        
                                        }
                                        SourceAray.unshift(sourced.id);
                                        sourced.id = SourceAray.pop();
                                        Table_Source[sourced.alt] = sourced.id;//更新即時桌面資源
                                        sourced.parentElement.style.zIndex = 20;
                                        sourced.style.zIndex = -20;
                                        resource.querySelectorAll('td')[4].querySelector('img').style.transform = "translate(0px, -100%)";
                                        switch (sourced.alt) {
                                            case "0": {
                                                sourced.style.transform = "translate(100%, 100%)";                             
                                                break; // 如果這裡沒有 break，則會繼續跑後面的 statement（不需要判斷有沒有符合條件）
                                            }
                                            case "1": {
                                                // 是去判斷 action === 'say_hi'
                                                sourced.style.transform = "translate(0%, 100%)";                             
                                                break;
                                            }
                                            case "2": {
                                                // 是去判斷 action === 'say_hi'
                                                sourced.style.transform = "translate(-100%, 100%)";                             
                                                break;
                                            }
                                            case "3": {
                                                // 是去判斷 action === 'say_hi'
                                                sourced.style.transform = "translate(100%, 0%)";                             
                                                break;
                                            }
                                            case "5": {
                                                // 是去判斷 action === 'say_hi'
                                                sourced.style.transform = "translate(-100%, 0%)";                             
                                                break;
                                            }
                                            case "6": {
                                                // 是去判斷 action === 'say_hi'
                                                sourced.style.transform = "translate(100%, -100%)";                             
                                                break;
                                            }
                                            case "7": {
                                                // 是去判斷 action === 'say_hi'
                                                sourced.style.transform = "translate(0%, -100%)";                             
                                                break;
                                            }
                                            case "8": {
                                                // 是去判斷 action === 'say_hi'
                                                sourced.style.transform = "translate(-100%, -100%)";                             
                                                break;
                                            }
                                            
                                            default: {
                                                break;
                                            }
                                            }
                                    
                                        
                                            setTimeout(function() {
                                                    // sourced.style.transform = "translate(0px, 0px)";
                                                    sourced.style.transform = "";
                                                    
                                                    resource.querySelectorAll('td')[4].querySelector('img').style.transform = "translate(0px, 0px)";
                                                    chec_cover_num.push(sourced.alt);
                                                    sourced.src = "https://img.lovepik.com/element/40118/6391.png_300.png";
                                                    console.log("蓋牌數"+chec_cover_num.length)
                                                            setTimeout(function() {
                                                            if(chec_cover_num.length == 2){
                                                            
                                                                resource.querySelectorAll('td')[chec_cover_num[0]].querySelector('img').src = "https://img.ixintu.com/download/jpg/202001/685de4b8d9f54ffe6d8a533e92772584.jpg!con";
                                                                resource.querySelectorAll('td')[chec_cover_num[1]].querySelector('img').src = "https://img.ixintu.com/download/jpg/202001/685de4b8d9f54ffe6d8a533e92772584.jpg!con";
                                                                document.getElementById("mask").style.display = "none";
                                                                document.getElementById("mask").style.zIndex = "0";
                                                                document.getElementsByClassName("board_desk")[0].style.zIndex = "0";
                                                                checkcover = 0;
                                                                chec_cover_num = [];//覆蓋完牌後，退出回合;
                                                                check_init = 0;//動作完成，退出回合;
                                                                check_ended = 1;//動作完成，退出回合，至下一round;
                                                                document.getElementById("regret").style.display = "none";

                                                            }
                                                        }, 500);
                                                    }, 500);
                                                
                                            return;
                                        }
                                    }//選擇蓋資源牌
                                    if(check_init == 1){//選擇資源
                                        sourced.id = SourceAray.pop();
                                        
                                        Table_Source[sourced.alt] = sourced.id;//更新即時桌面資源

                                        d.style.height = "18vh";
                                        d.style.transform = "";
                                        for (var i = 0; i < $(".hand-area td").length; i++) {
                                            if (document.getElementsByClassName('hand-area')[0].querySelectorAll('td')[i].innerHTML == "") {
                                                document.getElementsByClassName('hand-area')[0].querySelectorAll('td')[i].appendChild(d);//將卡牌從牌堆中轉至手牌區
                                                document.getElementsByClassName('hand-area')[0].querySelectorAll('td')[i].addEventListener('mousemove', function (event) {
                                                    event = event || window.event; // 兼容性處理

                                                    var mouseX = event.clientX;
                                                    var mouseY = event.clientY;
                                                    document.getElementsByClassName('tooltips')[0].innerHTML = "資源(燃料:Delta、箭體、酬載:BF) : <br/>" + this.querySelector('img').id 
                                                    document.getElementsByClassName('tooltips')[0].style.left = mouseX + "px";
                                                    document.getElementsByClassName('tooltips')[0].style.top = mouseY + "px";
                                                    document.getElementsByClassName('tooltips')[0].style.display = "block"
                                                });

                                                document.getElementsByClassName('hand-area')[0].querySelectorAll('td')[i].querySelector('img').addEventListener('click', function (event) {
                                                    if(check_init == 3){
                                                        console.log("test測試");
                                                        var imgtran = document.getElementsByClassName('hand-area')[0].querySelectorAll('td')[i].querySelector('img');
                                                        console.log("test測試"+imgtran);

                                                        console.log("test測試"+imgtran.style.transform);
                                                        if (imgtran.style.transform == "") {
                                                        
                                                            if (userHandchoice.length < 3) {
                                                                console.log("test移動");
                                                                imgtran.style.transform = "translate(0px, -30px)";
                                                                userHandchoice.push(imgtran.id);
                                                                console.log(userHandchoice);
                                                            }

                                                        } else {
                                                            console.log("tes失敗");

                                                            imgtran.style.transform = "";
                                                            userHandchoice = userHandchoice.filter(item => item !== imgtran.id);
                                                            console.log(userHandchoice);
                                                        }
                                                    }
                                                    else if(check_init == 0){

                                                        document.getElementById("round_move_back").style.display = "block";
                                                        document.getElementById("round_move_back").style.zIndex = 99;
                                                        document.getElementById("round_move_font").style.display = "block";
                                                        document.getElementById("round_move_font").style.zIndex = 100;
                                                        return;
                                                    }

                                                });

                                                document.getElementsByClassName('hand-area')[0].querySelectorAll('td')[i].addEventListener('mouseleave', function (event) {
                                                    document.getElementsByClassName('tooltips')[0].style.display = "none"
                                                });
                                                check_init = 0;//動作完成，退出回合
                                                check_ended = 1;//動作完成，退出回合，至下一round;
                                                document.getElementById("regret").style.display = "none";

                                                break;
                                            }
                                        }
                                    }
                                    
                                    
                                });
                                resource.querySelectorAll('td')[a].addEventListener('mousemove', function (event) {
                                    event = event || window.event; // 兼容性處理

                                    var mouseX = event.clientX;
                                    var mouseY = event.clientY;
                                    // console.log(this.querySelector('img').id);
                                    document.getElementsByClassName('tooltips')[0].innerHTML = "資源(燃料:LOX、箭體、酬載:BF) : <br/>" + this.querySelector('img').id
                                    document.getElementsByClassName('tooltips')[0].style.left = mouseX+"px";
                                    document.getElementsByClassName('tooltips')[0].style.top = mouseY+"px";
                                    document.getElementsByClassName('tooltips')[0].style.display = "block"
                                    // console.log('滑鼠的X座標為: ' + mouseX + ', 滑鼠的Y座標為: ' + mouseY);
                                    if(checkcover == 1){
                                        this.style.backgroundColor = "red";
                                    }

                                });
                                resource.querySelectorAll('td')[a].addEventListener('mouseleave', function (event) {
                                    document.getElementsByClassName('tooltips')[0].style.display = "none"
                                    if(checkcover == 1){
                                        this.style.backgroundColor = "";
                                    }
                                });
                            }
                            else{
                            resource.querySelectorAll('td')[a].addEventListener('click', function (e) {
                            if(check_init == 2){

                                document.getElementById("mask").style.display="block";
                                document.getElementById("mask").style.zIndex = "20";
                                //document.getElementById("mask").style.zIndex = "20";
                                document.getElementsByClassName("board_desk")[0].style.zIndex = "100";
                                checkcover = 1;
                                
                            }
                            
                        })
                    }
                        }
                    //給定任務並綁定功能
                    for (var a = 0; a < missions.querySelectorAll('td').length; a++) {
                            if (a <= 5) {
                                if (a == 4){
                                    //初階任務牌堆
                                    missions.querySelectorAll('td')[a].addEventListener('click', function (event) {
                                        if(check_init == 4){
                                            document.getElementById("mask").style.display="block";
                                            document.getElementById("mask").style.zIndex = "20";
                                            //document.getElementById("mask").style.zIndex = "20";
                                            document.getElementsByClassName("mission")[0].style.zIndex = "100";
                                            checkcover = 1;
                                            document.getElementById("mask").addEventListener("click",function(){
                                            document.getElementById("mask").style.display = "none";
                                            document.getElementById("mask").style.zIndex = "0";
                                            document.getElementsByClassName("mission")[0].style.zIndex = "0";
                                            checkcover = 0;
                                        })
                                        }
                                        else if(check_init == 0){

                                            document.getElementById("round_move_back").style.display = "block";
                                            document.getElementById("round_move_back").style.zIndex = 99;
                                            document.getElementById("round_move_font").style.display = "block";
                                            document.getElementById("round_move_font").style.zIndex = 100;
                                            return;
                                        }
                                    });
                                }
                                if (a != 4 & a != 0 & a != 2) {
                                    //洗牌分配任務
                                    //2023/12/12 棄置 統一由後端洗牌後傳至前端
                                    // if(!sessionStorage.getItem('Initshuffle')){//初次進入時，統一分配
                                    //     var Begineer = Preliminary.pop();
                                    //     missions.querySelectorAll('td')[a].querySelector('img').className = "";
                                    //     missions.querySelectorAll('td')[a].querySelector('img').id = Begineer["mission"];
                                    //     missions.querySelectorAll('td')[a].querySelector('img').className += Begineer['Payload']+" ";
                                    //     for (var clsname = 0; clsname < Begineer['Body'].length; clsname++) {
                                    //         missions.querySelectorAll('td')[a].querySelector('img').className += Begineer['Body'][clsname] + " ";
                                    //     }
                                    //     missions.querySelectorAll('td')[a].querySelector('img').alt = Begineer['Furl'];
                                    //     //即時更新用
                                    //     Table_Pre[a] = {
                                    //                     "mission":missions.querySelectorAll('td')[a].querySelector('img').id,
                                    //                     "Payload":missions.querySelectorAll('td')[a].querySelector('img').className.split(' ')[0],
                                    //                     "Body":missions.querySelectorAll('td')[a].querySelector('img').className.split(' ').slice(0,-1),
                                    //                     "Furl":missions.querySelectorAll('td')[a].querySelector('img').alt,
                                    //                     };
                                    // }else{
                                    //     missions.querySelectorAll('td')[a].querySelector('img').className = "";
                                    //     missions.querySelectorAll('td')[a].querySelector('img').id = Table_Pre[a]["mission"];
                                    //     missions.querySelectorAll('td')[a].querySelector('img').className += Table_Pre[a]['Payload']+" ";
                                    //     for (var clsname = 0; clsname < Table_Pre[a]['Body'].length; clsname++) {
                                    //         missions.querySelectorAll('td')[a].querySelector('img').className += Table_Pre[a]['Body'][clsname] + " ";
                                    //     }
                                    //     missions.querySelectorAll('td')[a].querySelector('img').alt = Table_Pre[a]['Furl'];
                                       
                                    // }
                                        //*****************     初階任務給定內容    *****************
                                        missions.querySelectorAll('td')[a].querySelector('img').className = "";
                                        missions.querySelectorAll('td')[a].querySelector('img').id = Table_Pre[a]["mission"];
                                        missions.querySelectorAll('td')[a].querySelector('img').className += Table_Pre[a]['Payload']+" ";
                                        for (var clsname = 0; clsname < Table_Pre[a]['Body'].length; clsname++) {
                                            missions.querySelectorAll('td')[a].querySelector('img').className += Table_Pre[a]['Body'][clsname] + " ";
                                        }
                                        missions.querySelectorAll('td')[a].querySelector('img').alt = Table_Pre[a]['Furl'];
                                        ////*****************    初階任務給定內容    *****************

                                        //初階任務
                                        missions.querySelectorAll('td')[a].addEventListener('mouseover', function (event) {

                                            var needed = this.querySelector('img').className.split(' ');
                                            var needed_furl = this.querySelector('img').alt;
                                            event = event || window.event; // 兼容性處理
                                            var mouseX = event.clientX;
                                            var mouseY = event.clientY;
                                            document.getElementsByClassName('tooltips')[0].innerHTML = "任務條件 <br/>需求酬載 : "
                                                + needed[0] +
                                                "<br/>需求燃料 : " +
                                                needed_furl +
                                                "<br/>需求箭體 : " + needed.slice(1) +
                                                "<br/>任務名稱 : " + this.querySelector('img').id;
                                            ;
                                            document.getElementsByClassName('tooltips')[0].style.left = mouseX + "px";
                                            document.getElementsByClassName('tooltips')[0].style.top = mouseY + "px";
                                            document.getElementsByClassName('tooltips')[0].style.display = "block";
                                            var resource_code = "";
                                            var confirm_mission_payload = 0;
                                            var confirm_mission_body = 0;
                                            var confirm_mission_push = 0;
                                            var choicebodyweight = 0;
                                            for (var i = 0; i < userHandchoice.length; i++) {
                                                console.log(userHandchoice[i]);
                                                resource_code = userHandchoice[i];
                                                if (resource_code == needed[0])//比對酬載
                                                {
                                                    confirm_mission_payload = 1;
                                                }
                                                for (var ri = 1; ri <= needed.length-1; ri++) {
                                                    if (resource_code == needed[ri])//比對箭體
                                                    {
                                                        confirm_mission_body = 1;
                                                        choicebodyweight = resource_code.slice(-1);
                                                    }
                                                }
                                                if (resource_code.slice(0,-2) == "Delta"){
                                                    confirm_mission_push = resource_code.slice(-2);
                                                }

                                            }
                                            
                                            document.getElementsByClassName('tooltips')[0].style.color = "red";
                                            console.log("確認酬載 : "+confirm_mission_payload);
                                            console.log("確認箭伸 : "+choicebodyweight);
                                            console.log("確認燃料 : "+confirm_mission_push)
                                            console.log("檢測結果:(判斷任務是否能執行)", confirm_mission);
                                            //檢測燃料是否足以執行任務
                                            if(confirm_mission_push != 0){
                                                var checkFurl = parseInt(confirm_mission_push) - parseInt(choicebodyweight);
                                                if(checkFurl>=needed_furl){
                                                    confirm_mission_push = 1;
                                                }else{
                                                    confirm_mission_push = 0;
                                                }
                                            }
                                            console.log("推進燃料數 : "+checkFurl);
                                            var confirm_mission = confirm_mission_body + confirm_mission_payload + confirm_mission_push;
                                            console.log(confirm_mission);
                                            if (confirm_mission >= 3) {
                                                $("#" + this.querySelector('img').id).animate({ top: "-10px" });
                                                $("#" + this.querySelector('img').id).animate({ top: "0px" });
                                                //$(this.querySelector('img')[0]).animate('top', "0px");
                                                console.log("#" + this.querySelector('img').id);
                                                document.getElementsByClassName('tooltips')[0].style.color = "green";

                                            }
                                        });
                                        missions.querySelectorAll('td')[a].addEventListener('mouseleave', function (event) {
                                            document.getElementsByClassName('tooltips')[0].style.display = "none";
                                            $("#" + this.querySelector('img').id).stop();
                                            document.getElementsByClassName('tooltips')[0].style.color = "black";

                                        });
                                        missions.querySelectorAll('td')[a].addEventListener('click', function (event) {
                                            
                                            var rowIndex = this.parentNode.rowIndex;
                                            var cellIndex = this.cellIndex;
                                            console.log("第"+rowIndex+"列，第"+cellIndex+"欄");
                                            if(checkcover == 1){
                                                    if(chec_cover_num.length != 0){
                                                        if(rowIndex== chec_cover_num[0][0]  & cellIndex == chec_cover_num[0][1] ){
                                                            return;
                                                        }
                                                    
                                                    }
                                                    
                                                    var needed = this.querySelector('img').className.split(' ');
                                                    var needed_furl = this.querySelector('img').alt;
                                                    if (needed.slice(1)[needed.slice(1).length - 1] == '') {
                                                        // 如果是空值，使用 pop 方法刪除最後一個元素                                           
                                                        needed.pop();
                                                        console.log( needed.slice(1))
                                                    }

                                                    Preliminary.unshift({"mission":this.querySelector('img').id,"Payload":needed[0],"Body":needed.slice(1),"Furl":needed_furl});
                                                
                                                    //重新賦值
                                                    var Begineer = Preliminary.pop();
                                                    console.log(Begineer);
                                                    this.querySelector('img').className = "";
                                                    this.querySelector('img').id = Begineer["mission"];
                                                    this.querySelector('img').className += Begineer['Payload']+" ";
                                                    for (var clsname = 0; clsname < Begineer['Body'].length; clsname++) {
                                                        this.querySelector('img').className += Begineer['Body'][clsname] + " ";
                                                    }
                                                    this.querySelector('img').alt = Begineer['Furl']
                                                    

                                                    missions.querySelectorAll('td')[4].querySelector('img').style.transform = "translate(0px, -100%)";
                                                    
                                                    switch (cellIndex) {
                                                        case 0: {
                                                            this.querySelector('img').style.transform = "translate(300%, 0%)";                             
                                                            break; // 如果這裡沒有 break，則會繼續跑後面的 statement（不需要判斷有沒有符合條件）
                                                        }
                                                        case 1: {
                                                            this.querySelector('img').style.transform = "translate(0%, 100%)";                             
                                                            break;
                                                        }
                                                        case 2: {
                                                            this.querySelector('img').style.transform = "translate(-300%, 0%)";                             
                                                            break;
                                                        }
                                                    
                                                        default: {
                                                            break;
                                                        }
                                                        }
                                                
                                                    var mission_ID = this.querySelector('img').id;
                                                    setTimeout(function() {
                                                            // sourced.style.transform = "translate(0px, 0px)";
                                                            console.log("ID = "+mission_ID);

                                                            console.log(document.getElementById(mission_ID));
                                                            document.getElementById(mission_ID).style.transform = "translate(0px, 0px)";
                                                            
                                                            missions.querySelectorAll('td')[4].querySelector('img').style.transform = "translate(0px, 0px)";
                                                            chec_cover_num.push([rowIndex,cellIndex]);
                                                            document.getElementById(mission_ID).src = "https://img.lovepik.com/element/40118/6391.png_300.png";
                                                            console.log("蓋牌數"+chec_cover_num.length)
                                                            setTimeout(function() {
                                                                    if(chec_cover_num.length == 2){
                                                                    
                                                                        //missions.querySelectorAll('td')[chec_cover_num[0]].querySelector('img').src = "static/mission.jpg";
                                                                        //missions.querySelectorAll('td')[chec_cover_num[1]].querySelector('img').src = "static/mission.jpg";
                                                                        missions.rows[chec_cover_num[0][0]].cells[chec_cover_num[0][1]].querySelector('img').src = "static/mission.jpg";
                                                                        missions.rows[chec_cover_num[1][0]].cells[chec_cover_num[1][1]].querySelector('img').src = "static/mission.jpg";
                                                                        document.getElementById("mask").style.display = "none";
                                                                        document.getElementById("mask").style.zIndex = "0";
                                                                        document.getElementsByClassName("mission")[0].style.zIndex = "0";
                                                                        checkcover = 0;
                                                                        chec_cover_num = [];//覆蓋完牌後，退出回合;
                                                                        check_ended = 1;//動作完成，退出回合，至下一round;
                                                                        document.getElementById("regret").style.display = "none";//動作完成，上一步按鈕移除
                                                                        check_init = 0;//動作完成，歸零;(此變數是控制玩家選擇的狀態-1 拿資源 -2 蓋資源 -3 出任務 -4 蓋任務)
                                                                    }
                                                            }, 1000);
                                                    }, 500);
                                                    


                                                 
                                                    return;
                                                }
                                                
                                                if (document.getElementsByClassName('tooltips')[0].style.color == "green") {
                                                $('#mission_complete').show();
                                                //document.getElementById("mission_complete").style.display = "block";
                                                $('#mission_complete').animate({height:"1400px"},2500);
                                                console.log("任務執行成功");
                                            
                                                var needed = this.querySelector('img').className.split(' ');
                                                //console.log(needed);
                                                var check_push = 0;//確認推進器
                                                var check_payload = 0;//確認酬載
                                                var push_no = 0;//確認推進器序號
                                                var payload_no = 0;//確認酬載序號
                                                var pushid = "";
                                                // console.log("刪除 : ", payloadid)
                                                for(var choicI = 0;choicI < userHandchoice.length;choicI ++){

                                                    if(userHandchoice[choicI].length == 7 || userHandchoice[choicI].length == 3 ){
                                                        pushid = "#"+userHandchoice[choicI];
                                                        document.getElementsByClassName("hand-area")[0].querySelector(pushid).parentElement.innerHTML = "";
                                                    }else{
                                                        pushid = "#"+userHandchoice[choicI];
                                                        document.getElementsByClassName("hand-area")[0].querySelector(pushid).style.transform = "";
                                                    }
                                                    
                                                }
                                                
                                                //document.getElementsByClassName("hand-area")[0].querySelector(payloadid).parentElement.innerHTML = "";
                                                userHandchoice = [];
                                                //任務執行成功內容
                                                var mission_done = this.querySelector('img');


                                                for (var b = 0; b < $(".tech tr").length; b++) {
                                                    var check = 0;//檢測欄位是否為1
                                                    console.log('測試b:', b);
                                                    console.log(document.getElementsByClassName('tech')[0].querySelectorAll('tr')[b].querySelectorAll('td').length);
                                                    for (var c = 0; c < document.getElementsByClassName('tech')[0].querySelectorAll('tr').length; c++) {
                                                        console.log('測試c:', c);
                                                        if (document.getElementsByClassName('tech')[0].querySelectorAll('tr')[b].querySelectorAll('td')[c].innerHTML == "")
                                                        {
                                                            var d = mission_done.cloneNode(true);//複製
                                                            mission_done.id = Preliminary.pop();
                                                            d.style.height = "8vh";
                                                            document.getElementsByClassName('tech')[0].querySelectorAll('tr')[b].querySelectorAll('td')[c].appendChild(d);
                                                            document.getElementsByClassName('tech')[0].querySelectorAll('tr')[b].querySelectorAll('td')[c].addEventListener('mousemove', function (event) {
                                                                event = event || window.event; // 兼容性處理
                                                                console.log("迴圈處理");

                                                                var mouseX = event.clientX;
                                                                var mouseY = event.clientY;
                                                                document.getElementsByClassName('tooltips')[0].innerHTML = "任務 : <br/>" + this.querySelector('img').id + "技術 : XXX"
                                                                document.getElementsByClassName('tooltips')[0].style.left = mouseX + "px";
                                                                document.getElementsByClassName('tooltips')[0].style.top = mouseY + "px";
                                                                document.getElementsByClassName('tooltips')[0].style.display = "block"
                                                            });

                                                            document.getElementsByClassName('tech')[0].querySelectorAll('tr')[b].querySelectorAll('td')[c].addEventListener('mouseleave', function (event) {
                                                                document.getElementsByClassName('tooltips')[0].style.display = "none"
                                                            });
                                                            check = 1
                                                            break;
                                                        }
                                                    
                                                    }
                                                    if (check == 1) {
                                                        break;
                                                    }
                                                }
                                                
                                                setTimeout(function() {
                                                    $('#mission_complete').animate({height:"0px"},2500);
                                                    setTimeout(function() {
                                                        $('#mission_complete').hide();
                                                        }, 2100);
                                                        

                                                            //document.getElementById("mission_complete").style.display = "none";
                                                }, 4000);
                                                setTimeout(() => {
                                                    var Begineer = Preliminary.pop();
                                                    console.log(Begineer);
                                                    this.querySelector('img').className = "";
                                                    this.querySelector('img').id = Begineer["mission"];
                                                    this.querySelector('img').className += Begineer['Payload']+" ";
                                                    for (var clsname = 0; clsname < Begineer['Body'].length; clsname++) {
                                                        this.querySelector('img').className += Begineer['Body'][clsname] + " ";
                                                    }
                                                    this.querySelector('img').alt = Begineer['Furl']
                                                    document.getElementById("regret").style.display = "none";
                                                    check_ended = 1;//動作完成，退出回合，至下一round; 
                                                    check_init = 0;//動作完成，退出回合;(此變數是控制玩家選擇的狀態-1 拿資源 -2 蓋資源 -3 出任務 -4 蓋任務)

                                                }, 5000);

                                            }
                                        });
                                    }
                            }
                            else {
                                if (a == 7){
                                    
                                        //初階任務牌堆
                                        missions.querySelectorAll('td')[a].addEventListener('click', function (event) {
                                            if(check_init == 4){
                                                document.getElementById("mask").style.display="block";
                                                document.getElementById("mask").style.zIndex = "20";
                                                //document.getElementById("mask").style.zIndex = "20";
                                                document.getElementsByClassName("mission")[0].style.zIndex = "100";
                                                checkcover = 1;
                                                document.getElementById("mask").addEventListener("click",function(){
                                                    document.getElementById("mask").style.display = "none";
                                                    document.getElementById("mask").style.zIndex = "0";
                                                    document.getElementsByClassName("mission")[0].style.zIndex = "0";
                                                    checkcover = 0;
                                                })
                                            }
                                            else if(check_init == 0){

                                                document.getElementById("round_move_back").style.display = "block";
                                                document.getElementById("round_move_back").style.zIndex = 99;
                                                document.getElementById("round_move_font").style.display = "block";
                                                document.getElementById("round_move_font").style.zIndex = 100;
                                                return;
                                            }
                                        });
                                    
                                }
                                if (a != 7 & a != 9 & a != 11) {
                                    //2023/12/12 棄置 統一由後端洗牌後傳至前端
                                    // if(!sessionStorage.getItem('Initshuffle')){//初次進入時，統一分配
                                    //     var Medium = Intermed.pop();
                                    //     missions.querySelectorAll('td')[a].querySelector('img').className = "";
                                    //     missions.querySelectorAll('td')[a].querySelector('img').id = Medium["mission"];
                                    //     missions.querySelectorAll('td')[a].querySelector('img').className += Medium['tech'][0] + " ";
                                    //     missions.querySelectorAll('td')[a].querySelector('img').className += Medium['tech'][1] + " ";
                                    //     missions.querySelectorAll('td')[a].querySelector('img').className += Medium['Payload'] + " ";
                                    //     for (var clsname = 0; clsname < Medium['Body'].length; clsname++) {
                                    //         missions.querySelectorAll('td')[a].querySelector('img').className += Medium['Body'][clsname] + " ";
                                    //     }

                                    //     missions.querySelectorAll('td')[a].querySelector('img').alt = Medium['Furl']
                                    //     //中階任務
                                    //     //即時更新用
                                    //     Table_Inter[a] = {
                                    //                     "tech":[Medium['tech'][0],Medium['tech'][1]],
                                    //                     "mission":missions.querySelectorAll('td')[a].querySelector('img').id,
                                    //                     "Payload":missions.querySelectorAll('td')[a].querySelector('img').className.split(' ')[0],
                                    //                     "Body":missions.querySelectorAll('td')[a].querySelector('img').className.split(' ').slice(0,-1),
                                    //                     "Furl":missions.querySelectorAll('td')[a].querySelector('img').alt,
                                                        
                                    //                     };
                                    // }else{
                                    //     missions.querySelectorAll('td')[a].querySelector('img').className = "";
                                    //     missions.querySelectorAll('td')[a].querySelector('img').id = Table_Inter[a]["mission"];
                                    //     missions.querySelectorAll('td')[a].querySelector('img').className += Table_Inter[a]['tech'][0] + " ";
                                    //     missions.querySelectorAll('td')[a].querySelector('img').className += Table_Inter[a]['tech'][1] + " ";
                                    //     missions.querySelectorAll('td')[a].querySelector('img').className += Table_Inter[a]['Payload'] + " ";
                                    //     for (var clsname = 0; clsname < Table_Inter[a]['Body'].length; clsname++) {
                                    //         missions.querySelectorAll('td')[a].querySelector('img').className += Table_Inter[a]['Body'][clsname] + " ";
                                    //     }

                                    //     missions.querySelectorAll('td')[a].querySelector('img').alt = Table_Inter[a]['Furl']
                                    //   
                                    // }
                                    //*****************     中階任務給定內容    *****************
                                        missions.querySelectorAll('td')[a].querySelector('img').className = "";
                                        missions.querySelectorAll('td')[a].querySelector('img').id = Table_Inter[a]["mission"];
                                        missions.querySelectorAll('td')[a].querySelector('img').className += Table_Inter[a]['tech'][0] + " ";
                                        missions.querySelectorAll('td')[a].querySelector('img').className += Table_Inter[a]['tech'][1] + " ";
                                        missions.querySelectorAll('td')[a].querySelector('img').className += Table_Inter[a]['Payload'] + " ";
                                        for (var clsname = 0; clsname < Table_Inter[a]['Body'].length; clsname++) {
                                            missions.querySelectorAll('td')[a].querySelector('img').className += Table_Inter[a]['Body'][clsname] + " ";
                                        }
                                        missions.querySelectorAll('td')[a].querySelector('img').alt = Table_Inter[a]['Furl']
                                    //*****************     中階任務給定內容    *****************
                                        
                                    missions.querySelectorAll('td')[a].addEventListener('mouseover', function (event) {
                                        console.log(this.querySelector('img').className);
                                        var needed = this.querySelector('img').className.split(' ');
                                        var needed_furl = this.querySelector('img').alt;
                                        event = event || window.event; // 兼容性處理
                                        var mouseX = event.clientX;
                                        var mouseY = event.clientY;
                                        document.getElementsByClassName('tooltips')[0].innerHTML = "任務條件 <br/>需求任務 : " + needed[0] + "/" + needed[1]+

                                            "<br/>需求酬載 : "
                                            + needed[2] +
                                            "<br/>需求燃料 : " +
                                            needed_furl +
                                            "<br/>需求箭體 : " + needed.slice(3) +
                                            "<br/>任務報酬 : " + this.querySelector('img').id;
                                        ;
                                        document.getElementsByClassName('tooltips')[0].style.left = mouseX + "px";
                                        document.getElementsByClassName('tooltips')[0].style.top = mouseY + "px";
                                        document.getElementsByClassName('tooltips')[0].style.display = "block";
                                        var resource_code = "";
                                        var confirm_mission = 0;
                                        var confirm_tech = 0;

                                        var confirm_mission_payload = 0;
                                        var confirm_mission_body = 0;
                                        var confirm_mission_push = 0;
                                        var choicebodyweight = 0;
                                        for (var i = 0; i < userHandchoice.length; i++) {
                                                console.log(userHandchoice[i]);
                                                resource_code = userHandchoice[i];
                                                if (resource_code == needed[2])//比對酬載
                                                {
                                                    confirm_mission_payload = 1;
                                                }
                                                for (var ri = 3; ri <= needed.length-1; ri++) {
                                                    if (resource_code == needed[ri])//比對箭體
                                                    {
                                                        confirm_mission_body = 1;
                                                        choicebodyweight = resource_code.slice(-1);
                                                    }
                                                }
                                                if (resource_code.slice(0,-2) == "Delta"){
                                                    confirm_mission_push = resource_code.slice(-2);
                                                }

                                        }
                                        console.log("確認酬載 : "+confirm_mission_payload);
                                        console.log("確認箭伸 : "+choicebodyweight);
                                        console.log("確認燃料 : "+confirm_mission_push)
                                        console.log("檢測結果:(判斷任務是否能執行)", confirm_mission);
                                        //檢測燃料是否足以執行任務
                                        if(confirm_mission_push != 0){
                                            var checkFurl = parseInt(confirm_mission_push) - parseInt(choicebodyweight);
                                            if(checkFurl>=needed_furl){
                                                confirm_mission_push = 1;
                                            }else{
                                                confirm_mission_push = 0;
                                            }
                                        }

                                            console.log("推進燃料數 : "+checkFurl);
                                        //技能確認
                                        for (var a = 0; a < document.getElementsByClassName("tech")[0].querySelectorAll('img').length; a++) {
                                            tech_code = document.getElementsByClassName("tech")[0].querySelectorAll('img')[a].id;
                                            for (var ri = 0; ri <= needed.length; ri++) {
                                                if (tech_code == needed[ri]) {
                                                    confirm_tech += 1;
                                                }
                                            }

                                        }
                                        document.getElementsByClassName('tooltips')[0].style.color = "red";
                                        confirm_mission = confirm_mission_body + confirm_mission_payload + confirm_mission_push;
                                        console.log("檢測結果:(判斷任務是否能執行)", confirm_mission);
                                        if (confirm_mission >= 3 & confirm_tech >= 1) {
                                            $("#" + this.querySelector('img').id).animate({ top: "-10px" });
                                            $("#" + this.querySelector('img').id).animate({ top: "0px" });
                                            //$(this.querySelector('img')[0]).animate('top', "0px");
                                            console.log("#" + this.querySelector('img').id);
                                            document.getElementsByClassName('tooltips')[0].style.color = "green";


                                        }
                                    });
                                    missions.querySelectorAll('td')[a].addEventListener('mouseleave', function (event) {
                                        document.getElementsByClassName('tooltips')[0].style.display = "none";
                                        $("#" + this.querySelector('img').id).stop();
                                        document.getElementsByClassName('tooltips')[0].style.color = "black";

                                    });

                                    missions.querySelectorAll('td')[a].addEventListener('click', function (event) {
                                            var rowIndex = this.parentNode.rowIndex;
                                            var cellIndex = this.cellIndex;
                                            console.log("第"+rowIndex+"列，第"+cellIndex+"欄");
                                            if(checkcover == 1){
                                                    if(chec_cover_num.length != 0){
                                                        if(rowIndex== chec_cover_num[0][0]  & cellIndex == chec_cover_num[0][1] ){
                                                            return;
                                                        }
                                                    
                                                    }
                                                    
                                                    var needed = this.querySelector('img').className.split(' ');
                                                    var need_tech = needed.slice(0,2)
                                                    var needed_furl = this.querySelector('img').alt;
                                                    if (needed.slice(1)[needed.slice(1).length - 1] == '') {
                                                        // 如果是空值，使用 pop 方法刪除最後一個元素                                           
                                                        needed.pop();
                                                        console.log( needed.slice(1))
                                                    }
                                                    //{ 'tech': ["A1A1", "A1A2"], 'mission': "A1A", "Payload": "AF1", "Body": ["AL_4", "ACM_3", "CMC_2"], "Furl": 15 },
                                                    console.log({'tech': need_tech,"mission":this.querySelector('img').id,"Payload":needed[2],"Body":needed.slice(3),"Furl":needed_furl});
                                                    Intermed.unshift({'tech': need_tech,"mission":this.querySelector('img').id,"Payload":needed[2],"Body":needed.slice(3),"Furl":needed_furl});
                                                
                                                    //重新賦值
                                                    var Medium = Intermed.pop();
                                                    this.querySelector('img').className = "";
                                                    this.querySelector('img').id = Medium["mission"];
                                                    this.querySelector('img').className += Medium['tech'][0] + " ";
                                                    this.querySelector('img').className += Medium['tech'][1] + " ";
                                                    this.querySelector('img').className += Medium['Payload'] + " ";
                                                    for (var clsname = 0; clsname < Medium['Body'].length; clsname++) {
                                                        this.querySelector('img').className += Medium['Body'][clsname] + " ";
                                                    }
                                                    this.querySelector('img').alt = Medium['Furl']
                                                    

                                                    missions.querySelectorAll('td')[7].querySelector('img').style.transform = "translate(0px, -100%)";
                                                    
                                                    switch (cellIndex) {
                                                        case 0: {
                                                            this.querySelector('img').style.transform = "translate(300%, 0%)";                             
                                                            break; // 如果這裡沒有 break，則會繼續跑後面的 statement（不需要判斷有沒有符合條件）
                                                        }
                                                        case 1: {
                                                            this.querySelector('img').style.transform = "translate(0%, -100%)";                             
                                                            break;
                                                        }
                                                        case 2: {
                                                            this.querySelector('img').style.transform = "translate(-300%, 0%)";                             
                                                            break;
                                                        }
                                                    
                                                        default: {
                                                            break;
                                                        }
                                                        }
                                                
                                                    var mission_ID = this.querySelector('img').id;
                                                    setTimeout(function() {
                                                            // sourced.style.transform = "translate(0px, 0px)";
                                                            console.log("ID = "+mission_ID);

                                                            console.log(document.getElementById(mission_ID));
                                                            document.getElementById(mission_ID).style.transform = "";
                                                            
                                                            missions.querySelectorAll('td')[7].querySelector('img').style.transform = "translate(0px, 0px)";
                                                            chec_cover_num.push([rowIndex,cellIndex]);
                                                            document.getElementById(mission_ID).src = "https://img.lovepik.com/element/40118/6391.png_300.png";
                                                            console.log("蓋牌數"+chec_cover_num.length)
                                                                    setTimeout(function() {
                                                                    if(chec_cover_num.length == 2){
                                                                    
                                                                        //missions.querySelectorAll('td')[chec_cover_num[0]].querySelector('img').src = "static/mission.jpg";
                                                                        //missions.querySelectorAll('td')[chec_cover_num[1]].querySelector('img').src = "static/mission.jpg";
                                                                        missions.rows[chec_cover_num[0][0]].cells[chec_cover_num[0][1]].querySelector('img').src = "static/mission.jpg";
                                                                        missions.rows[chec_cover_num[1][0]].cells[chec_cover_num[1][1]].querySelector('img').src = "static/mission.jpg";
                                                                        document.getElementById("mask").style.display = "none";
                                                                        document.getElementById("mask").style.zIndex = "0";
                                                                        document.getElementsByClassName("mission")[0].style.zIndex = "0";
                                                                        checkcover = 0;
                                                                        chec_cover_num = [];//覆蓋完牌後，退出回合;
                                                                        check_ended = 1;//動作完成，退出回合，至下一round;
                                                                        document.getElementById("regret").style.display = "none";//移除上一步
                                                                        check_init = 0;//動作完成，歸零
                                                                    }
                                                                }, 500);
                                                            }, 500);
                                                            
                
                                                    return;
                                                }
                                        if (document.getElementsByClassName('tooltips')[0].style.color == "green") {
                                                $('#mission_complete').show();
                                                //document.getElementById("mission_complete").style.display = "block";
                                                $('#mission_complete').animate({height:"1400px"},2500);

                                            //先刪除手牌
                                            for(var choicI = 0;choicI < userHandchoice.length;choicI ++){

                                                if(userHandchoice[choicI].length == 7 || userHandchoice[choicI].length == 3 ){
                                                    pushid = "#"+userHandchoice[choicI];
                                                    document.getElementsByClassName("hand-area")[0].querySelector(pushid).parentElement.innerHTML = "";
                                                }else{
                                                    pushid = "#"+userHandchoice[choicI];
                                                        document.getElementsByClassName("hand-area")[0].querySelector(pushid).style.transform = "";
                                                    }
                                            }
                                            //document.getElementsByClassName("hand-area")[0].querySelector(payloadid).parentElement.innerHTML = "";
                                            userHandchoice = [];

                                            console.log("任務執行成功");
                                            //任務執行成功內容
                                            var mission_done = this.querySelector('img');

                                        

                                            console.log(d)
                                            for (var b = 0; b < $(".build tr").length; b++) {

                                                var check = 0;//檢測欄位是否為1
                                                console.log('測試b:', b);
                                                console.log(document.getElementsByClassName('build')[0].querySelectorAll('tr')[b].querySelectorAll('td').length);
                                                for (var c = 0; c < document.getElementsByClassName('build')[0].querySelectorAll('tr')[b].querySelectorAll('td').length; c++) {
                                                    console.log('測試c:', c);
                                                    if (document.getElementsByClassName('build')[0].querySelectorAll('tr')[b].querySelectorAll('td')[c].innerHTML == "") {
                                                        var d = mission_done.cloneNode(true);//複製
                                                        mission_done.id = Intermediate.pop();
                                                        d.style.height = "8vh";
                                                        document.getElementsByClassName('build')[0].querySelectorAll('tr')[b].querySelectorAll('td')[c].appendChild(d);
                                                        document.getElementsByClassName('build')[0].querySelectorAll('tr')[b].querySelectorAll('td')[c].addEventListener('mousemove', function (event) {
                                                            event = event || window.event; // 兼容性處理
                                                            console.log("迴圈處理");

                                                            var mouseX = event.clientX;
                                                            var mouseY = event.clientY;
                                                            document.getElementsByClassName('tooltips')[0].innerHTML = "建設 : <br/>" + this.querySelector('img').id
                                                            document.getElementsByClassName('tooltips')[0].style.left = mouseX + "px";
                                                            document.getElementsByClassName('tooltips')[0].style.top = mouseY + "px";
                                                            document.getElementsByClassName('tooltips')[0].style.display = "block"
                                                        });

                                                        document.getElementsByClassName('build')[0].querySelectorAll('tr')[b].querySelectorAll('td')[c].addEventListener('mouseleave', function (event) {
                                                            document.getElementsByClassName('tooltips')[0].style.display = "none"
                                                        });
                                                        check = 1
                                                        break;
                                                    }

                                                }
                                                if (check == 1) {
                                                    break;
                                                }
                                            }
                                            
                                            setTimeout(function() {
                                                    $('#mission_complete').animate({height:"0px"},2500);
                                                    setTimeout(function() {
                                                        $('#mission_complete').hide();
                                                    }, 2100);
                                                    //document.getElementById("mission_complete").style.display = "none";
                                                    
                                            }, 4000);

                                            setTimeout(() => {
                                                var Medium = Intermed.pop();
                                                this.querySelector('img').className = "";
                                                this.querySelector('img').id = Medium["mission"];
                                                this.querySelector('img').className += Medium['tech'][0] + " ";
                                                this.querySelector('img').className += Medium['tech'][1] + " ";
                                                this.querySelector('img').className += Medium['Payload'] + " ";
                                                for (var clsname = 0; clsname < Begineer['Body'].length; clsname++) {
                                                    this.querySelector('img').className += Medium['Body'][clsname] + " ";
                                                }
                                                document.getElementById("regret").style.display = "none";
                                                check_ended = 1;//動作完成，退出回合，至下一round;
                                                check_init = 0;//動作完成，退出回合;
                                            }, 5000);
                                            // var Medium = Intermed.pop();
                                            // console.log(Medium);
                                            // this.querySelector('img').className = "";
                                            // this.querySelector('img').id = Medium["mission"];
                                            // this.querySelector('img').className += Medium['tech'][0] + " ";
                                            // this.querySelector('img').className += Medium['tech'][1] + " ";
                                            // this.querySelector('img').className += Medium['Payload'] + " ";
                                            // for (var clsname = 0; clsname < Begineer['Body'].length; clsname++) {
                                            //     this.querySelector('img').className += Medium['Body'][clsname] + " ";
                                            // }
                                            // document.getElementById("regret").style.display = "none";
                                            // check_ended = 1;//動作完成，退出回合，至下一round;
                                            // check_init = 0;//動作完成，退出回合;
                                        
                                            
                                        }

                                    });
                                }
                            }
                        }
                    
                    //給定Session
                    if(!sessionStorage.getItem('Initshuffle')){
                        sessionStorage.setItem('Initshuffle', "done");
                        //2023/12/12 POST資源棄置-POST資源統一由玩家結束回合時，由該玩家刷新數據，其他玩家依最新數據做更新
                        // $.ajax({
                        //             type: "POST",
                        //             url:  "resource",
                        //             data: JSON.stringify({
                        //                 "SourceAray":SourceAray,//loading 資源牌
                        //                 "Preliminary":Preliminary,    //loading 初階任務
                        //                 "Intermed":Intermed,     //loading 中階任務
                        //                 "user":sessionStorage.getItem('player'),
                        //                 "userHands":userHands,
                        //                 "userTech":userTech,
                        //                 "userBuild":userBuild,
                        //                 "Table_Source":Table_Source,//即時更新桌面
                        //                 "Table_Pre":Table_Pre,      //即時更新桌面
                        //                 "Table_Inter":Table_Inter,  //即時更新桌面
                        //                 "upd":0,  
                        //             }),
                        //             contentType: "application/json; charset=utf-8",
                        //             dataType: "json",
                        //             success: function (data) {
                        //                 console.log("pass");
                        //             }
                        //         });
                    }
                    }
                    
                });
            
            
            
            document.getElementsByClassName("col-md-8")[0].querySelectorAll("table")[0].addEventListener("click",function(){
                if(check_init == 99){
                    $("#block-round").fadeIn(100);
                    $("#block-round").animate({display:'block',top:'10vh'},300);
                    
                    $("#block-round").fadeOut(500);
                    $("#block-round").css("top",'0vh');
                    return;
                }
           
            });
            
            document.getElementsByClassName("triangle")[0].addEventListener("click",function(){
                if($('#ssdis').css("display") == "none"){
                    $('#ssdis').animate({top:"-200px"},1000);
                    $('#ssdis').show()
                    $('.triangle').animate({top:"-200px"},1000);
                    
                }else{
                    $('#ssdis').animate({top:"0px"},1000);
                    $('.triangle').animate({top:"0px"},1000);
                    $('#ssdis').hide(10);
                    console.log("123")

                }
            
            })  

        });//The End of the $(document).ready();
        
        function initPlay(it){
            console.log(it.id)
            if(it.id == "SelctSource"){
                document.getElementById("regret").style.display = "block";
                document.getElementById("round_move_back").style.display = "none";
                document.getElementById("round_move_back").style.zIndex = 0;
                document.getElementById("round_move_font").style.display = "none";
                document.getElementById("round_move_font").style.zIndex = 0;
                check_init = 1;

            }
            if(it.id == "CoverSource"){
                check_init = 2;//蓋資源牌
                document.getElementById("regret").style.display = "block";
                document.getElementById("round_move_back").style.display = "none";
                document.getElementById("round_move_back").style.zIndex = 0;
                document.getElementById("round_move_font").style.display = "none";
                document.getElementById("round_move_font").style.zIndex = 0;
                document.getElementsByClassName("board_desk")[0].querySelectorAll('td')[4].click();               

            }
            if(it.id == "ExcutMision"){
                console.log(it.id+"測試")
                check_init = 3;//執行任務
                document.getElementById("regret").style.display = "block";
                document.getElementById("round_move_back").style.display = "none";
                document.getElementById("round_move_back").style.zIndex = 0;
                document.getElementById("round_move_font").style.display = "none";
                document.getElementById("round_move_font").style.zIndex = 0;
                //document.getElementsByClassName("mission")[0].querySelectorAll('td')[4].click();               

            }
            if(it.id == "CoverMision"){
                check_init = 4;//蓋資源牌
                document.getElementById("regret").style.display = "block";
                document.getElementById("round_move_back").style.display = "none";
                document.getElementById("round_move_back").style.zIndex = 0;
                document.getElementById("round_move_font").style.display = "none";
                document.getElementById("round_move_font").style.zIndex = 0;
                document.getElementsByClassName("mission")[0].querySelectorAll('td')[7].click();               

            }
        }  

        function backstep(){
            check_init = 0;
            document.getElementById("round_move_back").style.display = "block";
            document.getElementById("round_move_back").style.zIndex = 99;
            document.getElementById("round_move_font").style.display = "block";
            document.getElementById("round_move_font").style.zIndex = 100;
            document.getElementById("regret").style.display = "none";
            console.log(document.getElementsByClassName("hand-area")[0].querySelectorAll('img'));
            for(var imgs = 0;imgs < document.getElementsByClassName("hand-area")[0].querySelectorAll('img').length;imgs++){
                document.getElementsByClassName("hand-area")[0].querySelectorAll('img')[imgs].style.transform = "";
                userHandchoice = [];
            }
       
        }

        
	</script>
</head>
    
<body>
    <div id="block-round" style="display:none;position: fixed;width: 30%;left: 35%;border: 3px solid;background-color: lightcoral;border-radius: 25px;padding: 30px;z-index: 99;">
        <h1 style="text-align: center;">還沒輪到你</h1>
          
      </div>
         <div class="tooltips" style="display:none">
          <span class="tooltiptext">Tooltip text</span>
            
        </div>
        
        <div id="mask" onclick="corverItem()" style="width: 100%;height: 100vh;display:none;position: fixed;background-color: black;opacity: 0.7;">
            <input  style="position: relative;text-align: center;width: 5%;left:95%;height: 10vh;font-size: 3vmin;"  class="btn btn-outline-danger" value="X" />
        </div>

        <div id="round_move_back" style="width: 100%;height: 100vh;display:none;position: fixed;background-color: black;opacity: 0.7;z-index: 99;">
                                  
        </div>
        <div id="round_move_font" style="width: 100%;height: 100vh;display:none;position: fixed;opacity: 1;z-index: 100;">

               <table id="initeveryround" style="position: relative;top:25vh;width: 80%;left: 10%;padding: 5px;">
                <tr>
                    <td colspan="4" style="font-size: 6vmin;color: white;text-align: center;">
                        <h1>Your turn</h1>
                    </td>
                </tr>
                <tr >
                    <td style="padding: 20px;"><input id="SelctSource" style="text-align: center;width: 100%;height: 30vh;font-size: 5vmin;"  class="btn btn-outline-success" value="選取資源" onclick="initPlay(this)" /></td>
                    <td style="padding: 20px;"><input id="CoverSource" style="text-align: center;width: 100%;height: 30vh;font-size: 5vmin;"  class="btn btn-outline-success" value="覆蓋資源" onclick="initPlay(this)" /></td>
                    <td style="padding: 20px;"><input id="ExcutMision" style="text-align: center;width: 100%;height: 30vh;font-size: 5vmin;"  class="btn btn-outline-success" value="執行任務" onclick="initPlay(this)" /></td>
                    <td style="padding: 20px;"><input id="CoverMision" style="text-align: center;width: 100%;height: 30vh;font-size: 5vmin;"  class="btn btn-outline-success" value="覆蓋任務" onclick="initPlay(this)" /></td>
                </tr>
               </table>                   
        </div>
        <div id="mission_complete">
            <main>
                <svg class="figure" viewBox="0 0 508 268" aria-hidden="true">
                  <path d="M305.2 156.6c0 4.6-.5 9-1.6 13.2-2.5-4.4-5.6-8.4-9.2-12-4.6-4.6-10-8.4-16-11.2 2.8-11.2 4.5-22.9 5-34.6 1.8 1.4 3.5 2.9 5 4.5 10.5 10.3 16.8 24.5 16.8 40.1zm-75-10c-6 2.8-11.4 6.6-16 11.2-3.5 3.6-6.6 7.6-9.1 12-1-4.3-1.6-8.7-1.6-13.2 0-15.7 6.3-29.9 16.6-40.1 1.6-1.6 3.3-3.1 5.1-4.5.6 11.8 2.2 23.4 5 34.6z" fill="#2E3B39" fill-rule="nonzero"/>
                  <path d="M282.981 152.6c16.125-48.1 6.375-104-29.25-142.6-35.625 38.5-45.25 94.5-29.25 142.6h58.5z" stroke="#FFF" stroke-width="3.396" fill="#6DDCBD"/>
                  <path d="M271 29.7c-4.4-10.6-9.9-20.6-16.6-29.7-6.7 9-12.2 19-16.6 29.7H271z" stroke="#FFF" stroke-width="3" fill="#2E3B39"/>
                  <circle fill="#FFF" cx="254.3" cy="76.8" r="15.5"/>
                  <circle stroke="#FFF" stroke-width="7" fill="#6DDCBD" cx="254.3" cy="76.8" r="12.2"/>
                  <path class="smoke" d="M507.812 234.24c0-2.16-.632-4.32-1.58-6.24-3.318-6.72-11.85-11.52-21.804-11.52-1.106 0-2.212.12-3.318.24-.474-11.52-12.956-20.76-28.282-20.76-3.318 0-6.636.48-9.638 1.32-4.74-6.72-14.062-11.28-24.806-11.28-.79 0-1.58 0-2.37.12-.79 0-1.58-.12-2.37-.12-10.744 0-20.066 4.56-24.806 11.28a35.326 35.326 0 00-9.638-1.32c-15.642 0-28.282 9.6-28.282 21.48 0 1.32.158 2.76.474 3.96a26.09 26.09 0 00-4.424-.36c-8.058 0-15.01 3.12-19.118 7.8-3.476-1.68-7.742-2.76-12.324-2.76-12.008 0-21.804 7.08-22.752 15.96h-.158c-9.322 0-17.38 4.32-20.856 10.44-4.108-3.6-10.27-6-17.222-6h-1.264c-6.794 0-12.956 2.28-17.222 6-3.476-6.12-11.534-10.44-20.856-10.44h-.158c-.948-9-10.744-15.96-22.752-15.96-4.582 0-8.69.96-12.324 2.76-4.108-4.68-11.06-7.8-19.118-7.8-1.422 0-3.002.12-4.424.36.316-1.32.474-2.64.474-3.96 0-11.88-12.64-21.48-28.282-21.48-3.318 0-6.636.48-9.638 1.32-4.74-6.72-14.062-11.28-24.806-11.28-.79 0-1.58 0-2.37.12-.79 0-1.58-.12-2.37-.12-10.744 0-20.066 4.56-24.806 11.28a35.326 35.326 0 00-9.638-1.32c-15.326 0-27.808 9.24-28.282 20.76-1.106-.12-2.212-.24-3.318-.24-9.954 0-18.486 4.8-21.804 11.52-.948 1.92-1.58 4.08-1.58 6.24 0 4.8 2.528 9.12 6.636 12.36-.79 1.44-1.264 3.12-1.264 4.8 0 7.2 7.742 13.08 17.222 13.08h462.15c9.48 0 17.222-5.88 17.222-13.08 0-1.68-.474-3.36-1.264-4.8 4.582-3.24 7.11-7.56 7.11-12.36z" fill="#E6E9EE"/>
                  <path fill="#6DDCBD" d="M239 152h30v8h-30z"/>
                  <path class="exhaust__line" fill="#E6E9EE" d="M250 172h7v90h-7z"/>
                  <path class="flame" d="M250.27 178.834l-5.32-8.93s-2.47-5.7 3.458-6.118h10.26s6.232.266 3.306 6.194l-5.244 8.93s-3.23 4.37-6.46 0v-.076z" fill="#AA2247"/>
                </svg>
                <h1 >The mission successfully! Congratulations!</p>

                 </main>
        </div>
    <form id="form1" runat="server" style="z-index:-1111">
       
         <div class="container-fluid">
        <div class="row">
        
            <div class="col-md-2" id="player_zone">
                <div class="card playerZone" style="position: relative;left: -5%;background-color:transparent;border: 0px solid green;">
                    <div class="card-body other-player" style="width: 110%;height: 70vh;" >
                        <h5 class="card-title">其他玩家資訊</h5>
                        <!-- 其他玩家資訊內容 -->
                    
                
                    </div> 
                </div>
            </div>
            <div class="col-md-8">

                <div class="card" style="background-color:transparent;border: 0px solid green;" >
                    <div class="card-body main_area" style="height:70vh;">
                        <div class="row">
                            

                            <div class="col-md-6" style="position: relative;">
                                <table class="board_desk" >
                                    <tr>
                                        <td><img  class="img-thumbnail" src="https://img.ixintu.com/download/jpg/202001/685de4b8d9f54ffe6d8a533e92772584.jpg!con" alt="Card Image"></td>
                                        <td><img class="img-thumbnail" src="https://img.ixintu.com/download/jpg/202001/685de4b8d9f54ffe6d8a533e92772584.jpg!con" alt="Card Image"></td>
                                        <td><img class="img-thumbnail" src="https://img.ixintu.com/download/jpg/202001/685de4b8d9f54ffe6d8a533e92772584.jpg!con" alt="Card Image"></td>
                                    </tr>
                                    <tr>
                                        <td><img class="img-thumbnail" src="https://img.ixintu.com/download/jpg/202001/685de4b8d9f54ffe6d8a533e92772584.jpg!con" alt="Card Image"></td>
                                        <td><img class="img-thumbnail" src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQJW6gpA0R1f_K3P03JN6g9wpCPe1NgYE463g&usqp=CAU" alt="Card Image"></td>
                                        <td><img class="img-thumbnail" src="https://img.ixintu.com/download/jpg/202001/685de4b8d9f54ffe6d8a533e92772584.jpg!con" alt="Card Image"></td>
                                    </tr>
                                    <tr>
                                        <td><img class="img-thumbnail" src="https://img.ixintu.com/download/jpg/202001/685de4b8d9f54ffe6d8a533e92772584.jpg!con" alt="Card Image"></td>
                                        <td><img class="img-thumbnail" src="https://img.ixintu.com/download/jpg/202001/685de4b8d9f54ffe6d8a533e92772584.jpg!con" alt="Card Image"></td>
                                        <td><img class="img-thumbnail" src="https://img.ixintu.com/download/jpg/202001/685de4b8d9f54ffe6d8a533e92772584.jpg!con" alt="Card Image"></td>
                                    </tr>
                                </table>
                            </div>

                            <div class="col-md-6" style="position: relative;">
                                
                                <table class="mission">
                                <tr>
                                    <td ></td>
                                        <td><img  class="BF3 LOX2 AL Ti" id="A1B1" src="static/mission.jpg" alt="Card Image"></td>
 
                                    <td ></td>
                                </tr>
                                <tr>
                                         <!-- O - A1A1是任務名稱 同時代表著一個酬載 完成後可獲得對應技術 -->
                                         <!-- X - A1A1是技術名稱 由一項任務來執行後獲得  -->

                                         <!-- 一項任務存在火箭燃料需求數值、 -->
                                            <!-- 且同時低階任務內容是可重複的，但技術不重複  -->
                                         <!-- 低階任務的燃料需求大致一致 有高有低 但會在一定範圍 -->
                                            <!-- 到了中階任務後所需燃料會大上一截，因此有必要拿到燃料效率提升技術 -->
                                         <!-- 任務條件或者可以設計成 :  -->
                                            <!-- 該任務需配備何種強度以上的材料才有辦法完成 -->
                                            <!-- 而配備的推進器燃料則可依材料性質而有不同的推進效率 -->
                                            <!-- 任務可以配為以下 -->
                                            <!-- 若火箭為 碳纖維強化聚合物 則火箭推進效率x2 ，例: 推進器數值2 就x2 = 4 -->
                                            <!-- 若火箭為 鈦合金 則火箭推進效率x1 ，例: 推進器數值2 就x1 = 2                                                                                        若火箭為 碳纖維強化聚合物 則火箭推進效率x2 ，例: 推進器數值2 就x2 = 4 -->
                                            <!-- 若火箭為 鋁合金 則火箭推進效率x1/2 ，例: 推進器數值2 就x1/2 = 1                                                                                        若火箭為 碳纖維強化聚合物 則火箭推進效率x2 ，例: 推進器數值2 就x2 = 4 -->

                                            
                                        <td><img class="BF1 LOX2 Ti SUS316" id="A1A1" src="static/mission.jpg" alt="Card Image" /></td>
                                                    
                                        <td>初階任務<br/><img class="img-thumbnail" src="static/mission_B.jpg" alt="Card Image" /></td>
                                        <td><img class="BF2 LOX2 AL SUS316 Ti" id="A1A2"  src="static/mission.jpg" alt="Card Image" /></td>
                                </tr>
                                <tr>
                                        <td><img class="A1A1 A1A2 BF1 LOX4 Ti CA" id="A1A" src="static/mission.jpg" alt="Card Image" /></td>                                                    
                                        <td>中階任務<br/><img  src="static/mission_A.jpg" alt="Card Image"></td>
                                        <td><img class="A1B1 A1B2 BF2 LOX4 Ti" id="A1B" src="static/mission.jpg" alt="Card Image"></td>
                                </tr>
                                <tr>
                                    <td ></td>
                                        <td><img class="B1A1 B1B2 BF3 LOX4 Ti" id="B1A" src="static/mission.jpg" alt="Card Image"></td>
                                    <td ></td>
                                </tr>
                            </table>
                            </div>
                            <div class="triangle"></div>
                            <div id="ssdis" style="position: relative;width: 100%;height: 30vh;top: 0px;display: none;border-radius: 25px;">
                                <table id="orderSheet" style="position: relative;width: 80%;left: 10%;top:20px;">
                                    <tr>
                                        <td>玩家</td>
                                        {% for i in range(Orderlen) %}
                                        <td ><img id="{{Order_ID[i][0]}}" style="width: 50%;" src="static/{{Order[i][0]}}.png"  alt="{{i}}"></td>
                                        
                                        {% endfor %}
                                     
                                    </tr>
                                    <tr>
                                        <td>次序</td>
                                        {% for i in range(Orderlen)  %}
                                        <td ><h2>{{i+1}}</h2></td>
                                        
                                        {% endfor %}
                                    </tr>
                                </table>
                            </div>
                        </div>
              
                  
                            
                    </div>
                </div>
            </div>
            <div class="col-md-2">
                <div class="card self-area" style="border: 0px solid green;">
                    <div class="card-body self-area-T">
                        <h5 class="card-title btn btn-light" >技術</h5>
                        <!-- 自己的頭像與手牌內容 -->
                        <table class="tech">
                            <tr>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                        </table>
                         <br/>
                        <h5 class="card-title btn btn-light" >建設</h5>
                         <br/>
                        <table class="build">
                            <tr>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                        </table>
                        <input id="regret" class="btn btn-warning" type="button" value="上一步" onclick="backstep()" style="position: absolute;bottom: 0px;height: 15vh;width: 100%;left: 0%;color: black;font-weight: bold;font-size: 3vmin;display: none;" />

                    </div>
                </div>
            </div>
             <div class="col-md-12" style="position:relative;height:30vh;bottom:0px;width:100%;">
                    <div class="row hand-area-T" style="bottom:0px;position:absolute;height:30vh;width:100%">
                        <div class="col-md-2" style="border:0px yellow solid;height:30vh;text-align:center">
                            <table>
                                <tr>
                                    <td style="color:wheat">
                                        米國
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <img id="avatar"  class="img-thumbnail" style="height:auto;width:80%" src="https://d1grca2t3zpuug.cloudfront.net/2019/11/kuniwordd01.jpg" alt="Card Image" />
                                    </td>
                                </tr>
                                
                            </table>

                        </div>
                        <div class="col-md-10">
                             <table class="hand-area">
                                <tr>
                                     <td></td>
                                     <td></td>
                                     <td></td>
                                     <td></td>
                                     <td></td>
                                     <td></td>
                                     <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                </tr>
                              
                            </table>
                        </div>
                    </div>
                 </div>
            </div>
       
       
    </div>
    <div class="OtherPlayer card bg-primary text-white mb-4" style="display: none;">
        <div class="card-body" style="background-image: url(https://www.technice.com.tw/wp-content/uploads/2022/12/148870586_fb-link.jpg);"><img  class="" style="height:auto;width:20%"  src="static/M2.png" alt=""><span></span></div>
        <div class="card-footer align-items-center justify-content-between">
            <table class="techs">
                <tr>
                    <td></td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td></td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td></td>
                    <td></td>
                    <td></td>
                </tr>
            </table>
            <br/>
            <table class="builds">
                <tr>
                    <td></td>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td></td>
                    <td></td>
                    <td></td>
                </tr>
            </table>
            <!-- <table class="techs">
                <tr>
                    <td><img class="B1A1 B1B2 BF3 LOX4 Ti" id="B1A" src="static/mission.jpg" style="width: 50%;" alt="Card Image"></td>
                    <td><img class="B1A1 B1B2 BF3 LOX4 Ti" id="B1A" src="static/mission.jpg" style="width: 50%;" alt="Card Image"></td>
                    <td><img class="B1A1 B1B2 BF3 LOX4 Ti" id="B1A" src="static/mission.jpg" style="width: 50%;" alt="Card Image"></td>
                </tr>
                <tr>
                    <td><img class="B1A1 B1B2 BF3 LOX4 Ti" id="B1A" src="static/mission.jpg" style="width: 50%;" alt="Card Image"></td>
                    <td><img class="B1A1 B1B2 BF3 LOX4 Ti" id="B1A" src="static/mission.jpg" style="width: 50%;" alt="Card Image"></td>
                    <td><img class="B1A1 B1B2 BF3 LOX4 Ti" id="B1A" src="static/mission.jpg" style="width: 50%;" alt="Card Image"></td>
                </tr>
                <tr>
                    <td><img class="B1A1 B1B2 BF3 LOX4 Ti" id="B1A" src="static/mission.jpg" style="width: 50%;" alt="Card Image"></td>
                    <td><img class="B1A1 B1B2 BF3 LOX4 Ti" id="B1A" src="static/mission.jpg" style="width: 50%;" alt="Card Image"></td>
                    <td><img class="B1A1 B1B2 BF3 LOX4 Ti" id="B1A" src="static/mission.jpg" style="width: 50%;" alt="Card Image"></td>
                </tr>
            </table>
            <br/>
            <table class="builds">
                <tr>
                    <td><img class="B1A1 B1B2 BF3 LOX4 Ti" id="B1A" src="static/mission.jpg" style="width: 50%;" alt="Card Image"></td>
                    <td><img class="B1A1 B1B2 BF3 LOX4 Ti" id="B1A" src="static/mission.jpg" style="width: 50%;" alt="Card Image"></td>
                    <td><img class="B1A1 B1B2 BF3 LOX4 Ti" id="B1A" src="static/mission.jpg" style="width: 50%;" alt="Card Image"></td>
                </tr>
                <tr>
                    <td><img class="B1A1 B1B2 BF3 LOX4 Ti" id="B1A" src="static/mission.jpg" style="width: 50%;" alt="Card Image"></td>
                    <td><img class="B1A1 B1B2 BF3 LOX4 Ti" id="B1A" src="static/mission.jpg" style="width: 50%;" alt="Card Image"></td>
                    <td><img class="B1A1 B1B2 BF3 LOX4 Ti" id="B1A" src="static/mission.jpg" style="width: 50%;" alt="Card Image"></td>
                </tr>
            </table> -->
        </div>
    </div>
    </form>
    
</body>
    
</html>
